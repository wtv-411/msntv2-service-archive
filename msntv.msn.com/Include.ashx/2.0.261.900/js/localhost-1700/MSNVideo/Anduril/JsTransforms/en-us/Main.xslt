function Background(div){this.Div = div;this.Draw1 = _bkDraw1;this.Draw2 = _bkDraw2;this.Show = _bkShow;this.Hide = _bkHide;this.Clear = _bkClear;}function _bkDraw1(){this.Div.className = "bkg1";this.Clear();}function _bkDraw2(){this.Div.className = "bkg2";this.Clear();var spn1 = addSpan(this.Div);spn1.className = "bkg2spn1";var spn2 = addSpan(this.Div);spn2.className = "bkg2spn2";var spn3 = addSpan(this.Div);spn3.className = "bkg2spn3";}function _bkShow(){this.Div.style.visibility = "visible";}function _bkHide(){this.Div.style.visibility = "hidden";}function _bkClear(){clearChildren(this.Div);}function Banner(div) {this.Div = div;this.Init = _baInit;this.Refresh = _baRefresh;this.Hide = _baHide;this.Show = _baShow;this.IsSelectable = _baIsSelectable;}function _baInit(){this.TextSpan = addSpan(this.Div);this.TextSpan.className = "bannerLogo";this.HelpBtn = addSpan(this.Div);this.HelpBtn.innerHTML = "Help <span class=\"bannerHelpImg\"></span>";InitNavObject(this.HelpBtn,"helpBtn","bannerHelp","","","","","","","clickHelp()");}function _baRefresh(){var txt = "MSN Video";if (g_nowVideoSize == VIDEOSIZE_SMALL){if (g_nowNavView == NAV_VIEW_PLAYLIST){txt += " &#151; Playlist";}else if (g_nowNavView == NAV_VIEW_BROWSE){txt += " &#151; " + g_topics[g_nowTopicInd];}}this.TextSpan.innerHTML = txt;}function _baHide(){this.Div.style.visibility = "hidden";}function _baShow(){this.Div.style.visibility = "visible";}function _baIsSelectable(){return (this.Div.style.visibility != "hidden");}function BrandingArea(div, cssClass) {this.Div = div;this.Clear = _brClear;this.Init = _brInit;this.Refresh = _brRefresh;this.Hide = _brHide;this.Show = _brShow;this.SetDimensions = _brSetDimensions;this.Div.className = cssClass;}function _brClear(){clearChildren(this.Div);}function _brInit(){this.Image = addImg(this.Div);this.Image.className = "brandingAreaImage";this.Image.src = "/Images/Shared/s.gif";}function _brSetDimensions(t, l, h, w){this.Image.style.top = t;this.Image.style.left = l;this.Image.style.height = h;this.Image.style.width = w;}function _brRefresh(){if (oPlaylist.Position==-1 || oMediaPlayer.IsPlayingAd || oMediaPlayer.GetPlayState()!=PLAYSTATE_PLAYING)this.Image.src = "/Images/Shared/s.gif";else if (oPlaylist.GetCurrent() != null)this.Image.src = "http://img.video.msn.com/s/us/sc/i/MSNTV/src/" + oPlaylist.GetCurrent().Source + ".gif";}function _brHide(){this.Div.style.visibility = "hidden";}function _brShow(){this.Div.style.visibility = "visible";}function BrowseHeader(div) {this.Div = div;this.Init = _bhInit;this.SetText1 = _bhSetText1;this.SetText2 = _bhSetText2;this.ShowLoadingMessage = _bhShowLoadingMessage;this.Clear = _bhClear;this.Hide = _bhHide;this.Show = _bhShow;}function _bhInit(){var ob;ob = addSpan(this.Div);ob.className = "browseHeaderTxt1";this.Text1 = ob;ob = addSpan(this.Div);ob.className = "browseHeaderTxt2";this.Text2 = ob;}function _bhSetText1(h){this.Text1.innerHTML = h;}function _bhSetText2(h){this.Text2.innerHTML = h;}function _bhShowLoadingMessage(str){this.Text1.innerHTML = "Please wait while we get " + str + " ready.";this.Text2.innerHTML = "";}function _bhClear(){this.Text1.innerHTML = "";this.Text2.innerHTML = "";}function _bhShow(){this.Div.style.visibility = "visible";}function _bhHide(){this.Div.style.visibility = "hidden";}function CategoryChooser(div, maxSubcats){this.Div = div;this.Init = _ccInit;this.Show = _ccShow;this.Hide = _ccHide;this.AppendBadCat = _ccAppendBadCat;this.ExcludeBtn = _ccExcludeBtn;this.MaxSubcats = maxSubcats;this.FailedSubcats = new Array();}function _ccInit(topics, cats, bottomY){var btn;var btns = new Array();for (var i=0; i<topics.length; i++){btns[i] = new Array();if (cats[i] != null){var bottomInd = (cats[i].length >= this.MaxSubcats) ? this.MaxSubcats : cats[i].length;for (var j=-1; j<cats[i].length; j++)  {if (j == bottomInd)break;btn = addSpan(this.Div);btn.innerHTML = (j==-1) ? "All" : cats[i][j];btn.Show = _ccShowOb;btn.Hide = _ccHideOb;btn.FullName = getTopic_Cat(i,j);btns[i][j+1] = btn;var upAction = (j==-1) ? "offBrowseButton()" : "";InitNavObject(btn,"mi_" + i + "_" + (j+1),"popup popupTop","popup popupTop popupTopHL","",upAction,"","offBrowseButton()","offBrowseButton()","clickBrwsBtn(" + i + "," + j + ")");}}}this.BottomY = bottomY;this.ButtonHeight = btn.offsetHeight;this.Btns = btns;}function _ccShow(topicInd, catInd){var bottomY = 0;for (var i=0; i<this.Btns.length; i++){if (this.Btns[i] == null)break;for (var j=this.Btns[i].length-1; j>=0; j--){var nowBtn = this.Btns[i][j];if (i!=topicInd || this.ExcludeBtn(nowBtn.FullName)){nowBtn.Hide();}else{if (j==catInd+1 && i==topicInd)nowBtn.SetHighlight(true);elsenowBtn.SetHighlight(false);nowBtn.style.bottom = bottomY;;bottomY += this.ButtonHeight;nowBtn.Show();}}}var popupHeight= (this.ButtonHeight * this.Btns[topicInd].length);this.Div.style.height = popupHeight;this.Div.style.top = this.BottomY - popupHeight;this.Div.style.visibility = "visible";try{this.Btns[topicInd][catInd+1].focus();  }catch (e){oFooter.SetFocus();}}function _ccHide(){for (var i=0; i<this.Btns.length; i++){if (this.Btns[i] != null){for (var j=0; j<this.Btns[i].length; j++){this.Btns[i][j].Hide();}}}this.Div.style.visibility = "hidden";}function _ccShowOb(){this.style.visibility = "visible";}function _ccHideOb(){this.style.visibility = "hidden";}function _ccAppendBadCat(topic_cat){for (var i=0; i<this.FailedSubcats.length; i++){if (this.FailedSubcats[i] == topic_cat)return;}this.FailedSubcats[this.FailedSubcats.length] = topic_cat;}function _ccExcludeBtn(btnName){for (var i=0; i<this.FailedSubcats.length; i++){if (this.FailedSubcats[i] == btnName)return true;}return false;}function Footer(div) {this.Div = div;this.DrawBrowseView = _ftDrawBrowseView;this.DrawHomeView = _ftDrawHomeView;this.DrawPlayingView = _ftDrawPlayingView;this.DrawPlaylistView = _ftDrawPlaylistView;this.Clear = _ftClear;this.IsSelectable = _ftIsSelectable;this.Hide = _ftHide;this.Show = _ftShow;this.SetFocus = _ftSetFocus;}function _ftDrawHomeView(){this.Clear();var arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.HomeMediaBtn = addSpan(this.Div);this.HomeMediaBtn.innerHTML = "Home Media: Video";InitNavObject(this.HomeMediaBtn,"homeMedia","footBtn","","","navAwayFromOb(oFooter,0,oFooter.HomeMediaBtn)","","","","toOfflineVideo()");this.Show();}function toOfflineVideo(){try{var urlA = window.external.SafeGetServiceURL('Video');var urlB = window.external.SafeGetServiceURL('Video::HomeNetworking');if (urlB != "")DeviceClickAway(urlB);elseDeviceClickAway(urlA);}catch (exception){}}function _ftDrawBrowseView(){var arrow;this.Clear();this.BrowseBtn = addSpan(this.Div);this.BrowseBtn.innerHTML = "Browse This Category";InitNavObject(oFooter.BrowseBtn,"browseBtn","popup popupBttm","","overBrowseButton()","","","","","clickBrowseButton()");arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = "All categories";InitNavObject(this.HomeBtn,"homeBtn","footBtn","","","", "","", "", "clickHomeButton()");arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.PlayAllBtn = addSpan(this.Div);this.PlayAllBtn.innerHTML = "Play all videos";InitNavObject(this.PlayAllBtn,"playAllBtn","footBtn","","","", "","", "","clickPlayAll()");this.Show();}function _ftDrawPlayingView(){var arrow;this.Clear();arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = "All categories";InitNavObject(this.HomeBtn,"homeBtn","footBtn","","","", "","","","clickHomeButton()");this.Show();}function _ftDrawPlaylistView(){var arrow;this.Clear();arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.HomeBtn = addSpan(this.Div);this.HomeBtn.innerHTML = "All categories";InitNavObject(this.HomeBtn,"homeBtn","footBtn","","","","","","","clickHomeButton()");arrow = addSpan(this.Div);arrow.innerHTML = bulletImage();arrow.className = "footArrw";this.EmptyBtn = addSpan(this.Div);this.EmptyBtn.innerHTML = "Empty Playlist";InitNavObject(this.EmptyBtn,"emptyBtn","footBtn","","","","","","","clickDeleteAll()");this.Show();}function _ftClear(){clearChildren(this.Div);}function _ftHide(){this.Div.style.visibility = "hidden";}function _ftShow(){this.Div.style.visibility = "visible";}function _ftSetFocus(){for (var i=0; i<this.Div.children.length; i++){var ob = this.Div.children[i];if (ob.ClickAction != null){ob.focus();return;}}}function _ftIsSelectable(){return (this.Div.style.visibility != "hidden");}function FullScreenPanel(div) {this.Div = div;this.Init = _fsInit;this.Hide = _fsHide;this.Show = _fsShow;}function _fsInit(){var ob;ob = addSpan(this.Div);ob.className = "fspBkg fspLeft";ob = addSpan(this.Div);ob.className = "fspBkg fspCenter";ob = addSpan(this.Div);ob.className = "fspBkg fspRight";}function _fsHide(){this.Div.style.visibility = "hidden";}function _fsShow(){this.Div.style.visibility = "visible";}function MediaPlayer(div, player, statusDiv){this.Div = div;this.Player = player;this.Status = statusDiv;this.Init = _mpInit;this.GetPlayState = _mpGetPlayState;this.GetMediaPosition = _mpGetMediaPosition;this.SetMediaPosition = _mpSetMediaPosition;this.GetDuration = _mpGetDuration;this.PlayMedia = _mpPlayMedia;this.Cancel = _mpCancel;this.Stop = _mpStop;this.Pause = _mpPause;this.Play = _mpPlay;this.Rew = _mpRew;this.Fwd = _mpFwd;this.SetDimensions = _mpSetDimensions;this.ResetDimensions =_mpResetDimensions;this.CurrentMediaType = _mpCurrentMediaType;this.Show = _mpShow;this.Hide = _mpHide;this.IsSelectable = _mpIsSelectable;this.ShowStatus = _mpShowStatus;this.IsLoading = false;this.IsPlayingAd = false;this.LastPlayState = "";}function _mpInit(){InitNavObject(this.Div,this.Div.id,"mediaPlayerDiv","","","","","","","clickPip()");}function _mpSetDimensions(left, top, width, height, topBorder, rightBorder, bottomBorder, leftBorder){this.Left = left;this.Top = top;this.Width = width;this.Height = height;this.Div.style.top = parseInt(top)-topBorder;this.Div.style.left = parseInt(left)-leftBorder;this.Div.style.width = parseInt(width)+leftBorder+rightBorder;this.Div.style.height = parseInt(height)+topBorder+bottomBorder;this.Player.style.left=left;this.Player.style.top=top;this.ResetDimensions();}function _mpResetDimensions(){try{this.Player.style.posWidth = this.Width;this.Player.style.posHeight = this.Height;this.Player.SetWindowRect(left, top, width, height);}catch (e){}}function _mpShow(makeSelectable){this.Div.style.visibility = (makeSelectable) ? "visible" : "hidden";  this.Player.style.display = "block";}function _mpHide(){this.Div.style.visibility = "hidden";this.Player.style.display = "none";}function _mpIsSelectable(){return this.Div.style.visibility != "hidden";}function _mpGetPlayState(){try{return this.Player.PlayState;}catch (exception){}}function _mpGetMediaPosition(){return this.Player.CurrentPosition*1000;}function _mpSetMediaPosition(posMS){this.Player.CurrentPosition = posMS / 1000;}function _mpGetDuration(){return this.Player.Duration;}function _mpPlayMedia(url){this.Player.FileName = url;this.Player.AutoStart = true;this.IsLoading = true;}function _mpCancel(){this.Player.Cancel();}function _mpStop(){this.Player.Stop();}function _mpPause(){this.Player.Pause();}function _mpPlay(){this.Player.Play();}function _mpCurrentMediaType(){switch (this.Player.PlayState){case 0 : return "";default : return "Video";}}function _mpRew(){var wmp = this.Player;wmp.AutoStart = false; if (wmp.CanScan && wmp.AllowScan){wmp.FastReverse();} else if (wmp.CanSeek){var length = wmp.Duration;if (length){var decrement = Math.min(Math.max(Math.round(length/10), 1), 60);var currentPos = wmp.CurrentPosition;if (currentPos <= decrement)wmp.CurrentPosition = 0;elsewmp.CurrentPosition = currentPos - decrement;}}}function _mpFwd(){var wmp = this.Player;wmp.AutoStart = false; if (wmp.CanScan && wmp.AllowScan){wmp.FastForward();}else if (wmp.CanSeek){var length = wmp.Duration;if (length){var increment = Math.min(Math.max(Math.round(length/10), 1), 60);var currentPos = wmp.CurrentPosition;if (currentPos + increment >= length)wmp.CurrentPosition = length;elsewmp.CurrentPosition = currentPos + increment;}}}function _mpShowStatus(s){this.Status.innerHTML = s;}var MGX_ICON_ERROR= 0x10;var MGX_ICON_WARNING= 0x30;var MGX_ICON_INFO= 0x40;var MGX_SIZE_LARGE = 0x0;var MGX_SIZE_SMALL = 0x1;function MessagePopup(){this.Error = _msError;this.Warning = _msWarning;this.Info = _msInfo;this.Confirm = _msConfirm;this.AutoHide = _msAutoHide;}function _msError(msg, caption){alert(msg);}function _msWarning(msg, caption){alert(msg);}function _msInfo(msg, caption){alert(msg);}function _msConfirm(msg){return confirm(msg);}function _msAutoHide(msg){alert(msg);}function NavBar(div){this.Div = div;this.Clear = _nbClear;this.Draw = _nbDraw;this.Refresh = _nbRefresh;this.InitTopics = _nbInitTopics;this.SetFocus = _nbSetFocus;this.SetRatchet = _nbSetRatchet;this.GetThumbIndex = _nbGetThumbIndex;this.InitThumbnails = _nbInitThumbnails;this.IsSelectable = _nbIsSelectable;this.Show = _nbShow;this.Hide = _nbHide;}function _nbClear(){this.Div.className = "navBarDiv navBarDivThmb";clearChildren(this.Div);}function _nbDraw(ind){this.CurrentRatchet = ind;var dividerX = -100;var ob;var css;for (var i=0; i<this.MenuCount; i++){ob = eval("menuItem_" + i);var j = ind+i;var lastItem = j==this.HTML.length;if (lastItem)dividerX = ob.offsetLeft;if (this.Spacers != null)this.Spacers[i].style.left = (lastItem) ? -100 : ob.offsetLeft - 8;if (j>=this.HTML.length)j-=this.HTML.length;ob.innerHTML = this.HTML[j];ob.GUID = this.GUIDs[j];}if (this.Hanger != null && this.HTML.length>this.MenuCount){var j = ind+i;if (j==this.HTML.length)dividerX = this.Hanger.offsetLeft;if (j>=this.HTML.length)j-=this.HTML.length;this.Hanger.innerHTML = imageTag(this.Images[j], 92, 69, "nbThmImg");}if (this.HTML.length>this.MenuCount){this.LeftArrow.innerHTML = "<span class=\"nbArrw nbArrw_l\">&nbsp;</span>";this.RightArrow.innerHTML = "<span class=\"nbArrw nbArrw_r\">&nbsp;</span>";}else{this.LeftArrow.innerHTML = ""; this.RightArrow.innerHTML = ""; }if (this.Divider != null){this.Divider.style.left = dividerX - (this.Mode == "thumbnails" ? 18 : 24);}this.Refresh();}function _nbRefresh(){if (this.Mode != "thumbnails")return;var doHighlight;for (var i=0; i<this.MenuCount; i++){try{ob = eval("menuItem_" + i);if (oPlaylist.GetCurrent() == null)doHighlight = false;else if (oPlaylist.GetCurrent().GUID == ob.GUID && oMediaPlayer.GetPlayState() != PLAYSTATE_STOPPED)doHighlight = true;elsedoHighlight = false;if (doHighlight){ob.ClassOff = "nbThmSpn nbThmSpnHilite";ob.ClassOver = "nbThmSpn nbThmSpnHilite";ob.ClassPressed = "nbThmSpn nbThmSpnHilite";ob.className = "nbThmSpn nbThmSpnHilite";ob.children[0].className = "nbThmTbl nbThmTblB";}else{ob.ClassOff = "nbThmSpn nbThmSpnWide";ob.ClassOver = "nbThmSpn nbThmSpnWide";ob.ClassPressed = "nbThmSpn nbThmSpnWide";ob.className = "nbThmSpn nbThmSpnWide";ob.children[0].className = "nbThmTbl nbThmTblA";}}catch (exception){break;}}}function _nbSetRatchet(ind){if (ind == -1)this.Draw(0);elsethis.Draw(ind);}function _nbSetFocus(){try{menuItem_0.focus();}catch (exception){}}function _nbGetThumbIndex(i){return ((i + this.CurrentRatchet) % this.HTML.length) + 1;}function _nbInitThumbnails(titles, images, guids, catName){this.Mode = "thumbnails";this.MenuCount = (titles.length >= 2) ? 2 : titles.length;this.Div.className = "navBarDiv navBarDivThmb";this.HTML = new Array();this.Images = new Array();this.GUIDs = guids;for (var i=0; i<titles.length; i++){var src = images[i];var txt = _nbTruncate(titles[i]);if (txt == "" || txt == " ")txt = catName + " clip";this.Images[i] = (src=="") ? "/Images/MSNVideo/GenericThumb.JPG" : src;var h = "<table width=\"189\" class=\"nbThmTbl nbThmTblA\">"+ "<tr>"+ "<td width=\"98\">"+ imageTag(this.Images[i], 92, 69, "nbThmImg")+ "</td>"+ "<td valign=top width=\"91\">"+ "<span class=\"nbThmTxt\">"+ txt+ "</span>"+ "</td>"+ "</tr>"+ "</table>";this.HTML[i] = h;}this.LeftArrow = addSpan(this.Div);this.LeftArrow.className = "nbArrSpn";for (var i=0; i<this.MenuCount; i++){ob = addSpan(this.Div);ob.id = "menuItem_" + i;var leftAction = (i==0) ? "ratchetNavBar('l'," + i + ")" : "";var rightAction = (i==this.MenuCount-1) ? "ratchetNavBar('r'," + i + ")" : "";InitNavObject(ob,ob.id,"nbThmSpn nbThmSpnWide","","overThumb(" + i + ")","","",leftAction,rightAction,"clickThumb(" + i + ")");}this.Hanger = addSpan(this.Div);this.Hanger.className = "nbThmSpn nbThmSpnNrrw";this.RightArrow = addSpan(this.Div);this.RightArrow.className = "nbArrSpn";this.Divider = addSpan(this.Div);this.Divider.className = "nbThmDvdrThmb";this.Divider.innerHTML = "&nbsp;";this.Divider.style.left = 560;this.Draw(0);}function _nbInitTopics(topics){this.Mode = "topics";this.MenuCount = 4;this.Div.className = "navBarDiv navBarDivIcon";this.HTML = new Array();this.GUIDs = new Array();for (var i=0; i<=topics.length; i++){var txt = (i==topics.length) ? "Playlist" : topics[i];var h = "<table class=\"nbIcnTab\">"+ "<tr>"+ "<td align=center>"+ txt + "</td>"+ "</tr>"+ "</table>";this.HTML[i] = h;}var ob;this.LeftArrow = addSpan(this.Div);this.LeftArrow.className = "nbArrSpn";var leftAction;var rightAction;for (var i=0; i<this.MenuCount; i++){ob = addSpan(this.Div);ob.id = "menuItem_" + i;leftAction = (i==0) ? "ratchetNavBar('l'," + i + ")" : "";rightAction = (i==this.MenuCount-1) ? "ratchetNavBar('r'," + i + ")" : "";InitNavObject(ob,ob.id,"nbIcnSpn","","","","",leftAction,rightAction,"clickIcon(" + i + ")");}this.RightArrow = addSpan(this.Div);this.RightArrow.className = "nbArrSpn";this.Divider = addSpan(this.Div);this.Divider.className = "nbThmDvdrIcon";this.Divider.innerHTML = "&nbsp;";this.Divider.style.left = 560;this.Spacers = new Array();for (var i=0; i<5; i++){var s = addSpan(this.Div);s.className = "nbVertDvdr";s.innerHTML = "&nbsp;";s.style.left = 560;this.Spacers[i] = s;}this.Draw(0);}function _nbHide(){this.Div.style.visibility = "hidden";}function _nbShow(){this.Div.style.visibility = "visible";}function _nbIsSelectable(){return this.Div.style.visibility != "hidden";}function _nbTruncate(s){try{var perWordMax = 9;var ww = s.split(" ");s = "";for (var i=0; i<ww.length; i++){var w = truncateWord(ww[i], perWordMax);s += w + " ";if (ww[i] != w){break;}}}catch (e){}s = truncateToHeight(85, 64, "16px", s);return s;}function NowPlaying(div) {this.Div = div;this.Init = _npInit;this.Refresh = _npRefresh;this.Clear = _npClear;this.Hide = _npHide;this.Show = _npShow;this.IsSelectable = _npIsSelectable;this.SelectableOb;}function _npInit(){}function _npRefresh(userStopped){this.Clear();if(oPlaylist.GetCurrent() == null)return;if (userStopped){var txt = addSpan(this.Div);txt.innerHTML = "You have stopped the video. <p/> Choose Play to begin again.";txt.className = "npMsg";this.SelectableOb = null;}else if (oMediaPlayer.IsPlayingAd){var txt = addSpan(this.Div);txt.innerHTML = "Up next after this advertisement:";txt.className = "npMsg";txt = addSpan(this.Div);txt.innerHTML = oPlaylist.GetCurrent().Title;txt.className = "npUpNxt";var arrw = addSpan(this.Div);arrw.innerHTML = bulletImage();arrw.className = "npArrw";this.MoreInfoBtn = addSpan(this.Div);this.MoreInfoBtn.innerHTML = "More info";InitNavObject(this.MoreInfoBtn,"moreInfoButton","","","","","","","","clickMoreInfo()");this.SelectableOb = this.MoreInfoBtn;}else{if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){var txt = addSpan(this.Div);txt.innerHTML = oPlaylist.GetCurrent().Title;txt.className = "npTitle";var arrw = addSpan(this.Div);arrw.innerHTML = bulletImage();arrw.className = "npArrw";this.MoreInfoBtn = addSpan(this.Div);this.MoreInfoBtn.innerHTML = "More info";InitNavObject(this.MoreInfoBtn,"moreInfoButton","","","","","","","","clickMoreInfo()");this.SelectableOb = this.MoreInfoBtn;}else{var txt = addSpan(this.Div);txt.innerHTML = "Please wait while we get your video ready.";txt.className = "npMsg";this.SelectableOb = null;}}}function _npClear(){clearChildren(this.Div);}function _npShow(){this.Div.style.visibility = "visible";}function _npHide(){this.Div.style.visibility = "hidden";}function _npIsSelectable(){return ((this.Div.style.visibility != "hidden") && (this.SelectableOb!=null));}function OnDeckArea(div) {this.Div = div;this.Init = _odInit;this.Refresh = _odRefresh;this.Hide = _odHide;this.Show = _odShow;this.IsSelectable = _odIsSelectable;}function _odInit(){var ob;ob = addSpan(this.Div);ob.className = "odThumb";this.ThumbSpan = ob;ob = addSpan(this.Div);ob.className = "odTxt1";this.TextSpan1 = ob;ob = addSpan(this.Div);ob.className = "odTxt2";this.TextSpan2 = ob;ob = addSpan(this.Div);ob.className = "odTxt3";this.TextSpan3 = ob;}function _odRefresh(){this.ThumbSpan.innerHTML = "";this.TextSpan1.innerHTML = "";this.TextSpan2.innerHTML = "";this.TextSpan3.innerHTML = "";if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING && !oMediaPlayer.IsPlayingAd){if ((oPlaylist.Position == -1) || (oPlaylist.Position+1 >= oPlaylist.Items.length)){this.TextSpan3.innerHTML = "Up next: end of playlist";}else{var currentItem = oPlaylist.Items[oPlaylist.Position+1];this.ThumbSpan.innerHTML = imageTag(currentItem.Thumb, 92, 69, "");this.TextSpan1.innerHTML = "Up next:";this.TextSpan2.innerHTML = currentItem.Title;}}}function _odShow(){this.Div.style.visibility = "visible";}function _odHide(){this.Div.style.visibility = "hidden";}function _odIsSelectable(){return false;}function onBuffering(bStart){if (bStart){}else{refreshStatus();}}var g_ReadyState = 0; var rs_Uninitialized = 0;var rs_Loading = 1;var rs_Interactive = 3;var rs_Complete = 4;var g_clipLoadTimer;var g_adIsLoading;function onReadyStateChange(lReadyState){var hasLoaded = (g_ReadyState == rs_Loading && lReadyState == rs_Complete);refreshStatus();if (hasLoaded){oMediaPlayer.IsLoading = false;window.clearTimeout(g_clipLoadTimer);g_ForceFullStop = false; refreshPlaystateFeedback();oProgressBar.Reset();if (!oMediaPlayer.IsPlayingAd){if (oPlaylist.GetCurrent() != null){trackViewedClip(oPlaylist.GetCurrent().GUID);}}oMediaPlayer.ResetDimensions();}g_ReadyState = lReadyState;}function setClipLoadTimer(seconds, isAd){g_adIsLoading = isAd;var mls = parseInt(seconds)*1000;g_clipLoadTimer = window.setTimeout(function() {checkClipLoad();}, mls);}function checkClipLoad(){window.clearTimeout(g_clipLoadTimer);if(oMediaPlayer.IsLoading)  {oMediaPlayer.IsLoading = false;oMediaPlayer.Cancel();if (g_adIsLoading){}else{var clip = oPlaylist.GetCurrent();if (clip != null){oMessagePopup.Warning("The video is not available", "");trackViewedClip(clip.GUID);}}postStopAction();return;}}var g_Rewinding = false;var g_ForceFullStop = false;var PLAYSTATE_STOPPED = 0;var PLAYSTATE_PAUSED = 1;var PLAYSTATE_PLAYING = 2;var PLAYSTATE_BUFFERING = 3;var PLAYSTATE_FWD = 4;var PLAYSTATE_REW = 5;var PLAYSTATE_FINISHED = -1;function onPlayStateChange(oldState, newState){refreshStatus();if (oldState == PLAYSTATE_BUFFERING && newState == PLAYSTATE_STOPPED){return;}switch (oMediaPlayer.GetPlayState()){case PLAYSTATE_STOPPED:postStopAction();    break;                case PLAYSTATE_BUFFERING:        break;case PLAYSTATE_PAUSED:g_Rewinding = false;postPauseAction();break;case PLAYSTATE_PLAYING:g_Rewinding = false;postPlayAction();break;case PLAYSTATE_FINISHED:break;case PLAYSTATE_FWD:g_Rewinding = false;break;case PLAYSTATE_REW:g_Rewinding = true;break;}}function postStopAction(){var l_ForceFullStop = g_ForceFullStop;var l_Rewinding = g_Rewinding;g_ForceFullStop = false;g_Rewinding = false;var action;if (l_ForceFullStop){}else if (l_Rewinding){window.setTimeout(function() {oMediaPlayer.Play();}, 1);}else if (oMediaPlayer.IsPlayingAd){oMediaPlayer.IsPlayingAd = false;  playCurrent();}else if (oPlaylist.Position+1 < oPlaylist.Items.length){oPlaylist.MoveNext();playCurrent();}else{onPlaylistEnd();}}function postPlayAction(){}function postPauseAction(){}function playItemAfterAd(ind){if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){if (oMediaPlayer.IsPlayingAd){oPlaylist.MoveTo(ind); }else{oPlaylist.MoveTo(ind-1); oMediaPlayer.Stop();}}else{oPlaylist.MoveTo(ind); playCurrent();}}function playCurrent(){if (oMediaPlayer.IsPlayingAd){if (oMediaPlayer.GetPlayState() != PLAYSTATE_PLAYING)oMediaPlayer.Play();return;}if (oPlaylist.GetCurrent() == null)return;onPrepareToPlay();if (oPlaylist.GetCurrent().GUID != oAdManager.CurrentGUID){oAdManager.CurrentGUID = oPlaylist.GetCurrent().GUID;oAdManager.SetPageGroup(oPlaylist.GetCurrent().PageGroup);oMediaPlayer.IsPlayingAd = oAdManager.EndUserSees=="video";}refreshPlaystateFeedback();iPlayNextTimerId = window.setTimeout(playCurrentB, 100);}function playCurrentB(){window.clearTimeout(iPlayNextTimerId);if (oMediaPlayer.IsPlayingAd){oAdManager.LoadNext();}else{if (oPlaylist.GetCurrent() != null){var url = oPlaylist.GetCurrent().URL;if (url.indexOf("/default.cdnx/") != -1)url += ".asx";oMediaPlayer.PlayMedia(url);oTrackingManager.TrackContentPlay(oPlaylist.GetCurrent());setClipLoadTimer(30, false);}}}function onLoadAdComplete(){oAdManager.ShowLeaveBehind();if (oMediaPlayer.IsPlayingAd){if (oAdManager.ClipSrc == "" || oAdManager.ClipSrc.indexOf(".gif") != -1){postStopAction();}else{oMediaPlayer.PlayMedia(oAdManager.ClipSrc);oTrackingManager.TrackAdPlay(oPlaylist.GetCurrent(), oAdManager.TrackingImgId);setClipLoadTimer(15, true);}}}function ProgressBar(div){this.Div = div;this.Init = _pbInit;this.Refresh = _pbRefresh;this.Reset = _pbReset;this.Hide = _pbHide;this.Show = _pbShow;this.SetStatus = _pbSetStatus;}function _pbInit(player, barWidth){var h = "<table cellspacing='0' cellpadding='0'>"+ "<tr>"+ "<td id='pbTxt1' width='50'>"+ "</td>"+ "<td width='80'>"+ "<msntv:progressbar id='pbHtc' ";h += "pngReferencePrefix='background:url' assetReferencePath='/Shared/Anduril/Images/en-us/_debug'";h += "/>"+ "</td>"+ "<td width='5'>"+ "</td>"+ "<td id='pbTxt2' width='70'>"+ "</td>"+ "<td width='115'>"+ "<span id='pbTxt3'>"+ "</span>"+ "</td>"+ "</tr>"+ "</table>";this.Div.innerHTML = h;this.Htc = pbHtc;this.Text1 = pbTxt1;this.Text2 = pbTxt2;this.StatusText = pbTxt3;this.Visible = false;this.Player = player;this.BarWidth = barWidth;}function _pbReset(){if (this.Visible){this.Text1.innerHTML = "00:00";this.Duration = Math.floor(this.Player.GetDuration());var mm = Math.floor(this.Duration/60);var ss = this.Duration - mm*60;this.Text2.innerHTML= ((mm < 10) ? "0" + mm : mm)+ ":"+ ((ss < 10) ? "0" + ss : ss);this.Htc.percentComplete = 0;this.Refresh();}}function _pbRefresh(){window.clearTimeout(this.TimerId);if (this.Visible){try{var mls = this.Player.GetMediaPosition();var sec = Math.floor(mls/1000);var mm = Math.floor(sec/60);var ss = sec - mm*60;if (mm == -1){this.Text1.innerHTML = "00:00";}else{this.Text1.innerHTML= ((mm < 10) ? "0" + mm : mm)+ ":"+ ((ss < 10) ? "0" + ss : ss);}this.Htc.percentComplete = Math.round(sec/this.Duration*100);}catch (exception){this.Text1.innerHTML = "00:00";this.Htc.percentComplete = 0;}this.TimerId = window.setTimeout(function() {oProgressBar.Refresh();}, 1000);}}function _pbHide(){clearTimeout(this.TimerId);this.Div.style.visibility = "hidden";this.Visible = false;}function _pbShow(){this.Visible = true;this.Reset();this.Div.style.visibility = "visible";}function _pbSetStatus(s){this.StatusText.innerHTML = s;}function SlideShow(slidePanel, abstractDiv){this.SlidePanel = slidePanel;this.AbstractDiv = abstractDiv;this.Init = _ssInit;this.Clear = _ssClear;this.Next = _ssNext;this.Hide = _ssHide;this.Show = _ssShow;this.ShowAbstract = _ssShowAbstract;this.PanelIsSelectable = _ssPanelIsSelectable;this.AbstractIsSelectable = _ssAbstractIsSelectable;}function _ssInit(slideHtml, abstractHtml){this.Clear();this.AbstractHtml = abstractHtml;this.Slides = new Array();var slide;for (var i=0; i<slideHtml.length; i++){slide = addSpan(this.SlidePanel);slide.style.display = "none";slide.innerHTML = slideHtml[i];slide.ShowcaseIndex = i;this.Slides[i] = slide;}this.CurrentSlide = 0;this.TextArea = addSpan(this.AbstractDiv);;this.Button = addButton(this.AbstractDiv, "Play Top Videos");InitNavObject(this.Button,"playTopButton","ssBtn","","","","","","","clickPlayTop()");InitNavObject(this.SlidePanel,"slideShowPanel","ssPanel","","","","","","","clickSlide()");}function _ssClear(){clearChildren(this.SlidePanel);clearChildren(this.AbstractDiv);}function _ssNext(){this.Slides[this.CurrentSlide].style.display="none";this.CurrentSlide = (this.CurrentSlide+1) % this.Slides.length;this.Slides[this.CurrentSlide].style.display="inline";this.ShowAbstract();}function _ssHide(){this.SlidePanel.style.visibility = "hidden";this.AbstractDiv.style.visibility = "hidden";}function _ssShow(){this.SlidePanel.style.visibility = "visible";this.AbstractDiv.style.visibility = "visible";this.Slides[this.CurrentSlide].style.display="inline";this.ShowAbstract();}function _ssPanelIsSelectable(){return (this.SlidePanel.style.visibility != "hidden");}function _ssShowAbstract(){this.TextArea.innerHTML = this.AbstractHtml[this.CurrentSlide];}function _ssAbstractIsSelectable(){return (this.AbstractDiv.style.visibility != "hidden");}function addButton(toOb, txt){var btn = document.createElement("<input type=\"button\" value=\"" + txt + "\" />");return toOb.appendChild(btn);}function bulletImage(){var h = "<img width='7' height='14' ";h += "src='/Shared/Anduril/Images/en-us/_debug/Shared/Images/BulletCustom.gif' ";h += "/>";return h;}function DeviceClickAway(url){if (okToLeaveApp())location.href = url;}function playSound(){}function truncateToHeight(w, h, lineH, html){var doTruncate;textGauge.style.display = "block";textGauge.style.width = w;textGauge.style.height = h;textGauge.style.lineHeight = lineH;textGauge.innerHTML = html;if (textGauge.offsetHeight == h){doTruncate = false;}else{textGauge.style.height = h;textGauge.innerHTML = "";var w = html.split(" ");var htmlThatFits = "";for (var i=0; i<w.length; i++){textGauge.innerHTML += w[i] + " ";if (textGauge.offsetHeight > h){doTruncate = true;break;}htmlThatFits = textGauge.innerHTML;}}textGauge.style.display = "none";if (doTruncate){var tHtml = htmlThatFits;var lastChar = (tHtml.charAt(tHtml.length-2) == ",") ? tHtml.length-2 : tHtml.length-1;tHtml = tHtml.substring(0,lastChar);return (tHtml == "") ? "" : tHtml + "&#133;";}else{return html;}}function truncateWord(w, maxChars){var s = "";var c = "";for (var i=0; i<w.length; i++){c = w.charAt(i);if ( (i < maxChars) && (c!="&") ){s += c;}else{if (i!=0)s += "&#133;";break;}}return s;}function VideoControls(div) {this.Div = div;this.Init = _vcInit;this.Hide = _vcHide;this.Show = _vcShow;this.PlayingView = _vcPlayingView;this.FullScreenView = _vcFullScreenView;this.HideShowBtns = _vcHideShowBtns;this.RefreshMute = _vcRefreshMute;this.SetStatus = _vcSetStatus;this.IsSelectable = _vcIsSelectable;}function _vcInit(){this.Mute = addSpan(this.Div);this.UnMute = addSpan(this.Div);this.Play = addSpan(this.Div);this.Pause = addSpan(this.Div);this.Stop = addSpan(this.Div);this.Rew = addSpan(this.Div);this.Fwd = addSpan(this.Div);this.Prev = addSpan(this.Div);this.Next = addSpan(this.Div);this.FullScreenBtn = addButton(this.Div, "Full&nbsp;Screen");this.NormalViewBtn = addButton(this.Div, "Normal&nbsp;View");this.Status = addSpan(this.Div);this.Status.className = "vcStatus";InitNavObject(this.Mute,"vcMuteBtn","vcBtn vcMuteBtn","","","","","","","_vcClickMute()");InitNavObject(this.UnMute,"vcUnMuteBtn","vcBtn vcUnmuteBtn","","","","","","","_vcClickMute()");InitNavObject(this.Play,"vcPlayBtn","vcBtn vcPlayBtn","","","","","","","_vcClickPlay()");InitNavObject(this.Pause,"vcPauseBtn","vcBtn vcPauseBtn","","","","","","","_vcClickPause()");InitNavObject(this.Stop,"vcStopBtn","vcBtn vcStopBtn","","","","","","","_vcClickStop()");InitNavObject(this.Rew,"vcRewBtn","vcBtn vcRewBtn","","","","","","","_vcClickRew()");InitNavObject(this.Fwd,"vcFwdBtn","vcBtn vcFwdBtn","","","","","","","_vcClickFwd()");InitNavObject(this.Prev,"vcPrevBtn","vcBtn vcPrevBtn","","","","","","","_vcClickPrev()");InitNavObject(this.Next,"vcSkipBtn","vcBtn vcNextBtn","","","","","","","_vcClickNext()");InitNavObject(this.FullScreenBtn,"fullScreenLink","vcFullScrn","","","","","","","clickFullScreen()");InitNavObject(this.NormalViewBtn,"normalViewBtn","vcNormView","","","","","","","clickNormalView()");}function _vcSetStatus(str){this.Status.innerHTML = str;}function _vcHideShowBtns(){try{var showRew;var showFwd;var showPrev;var showSkip;if (oMediaPlayer.GetPlayState() == PLAYSTATE_BUFFERING){showRew = false;showFwd = false;showPrev = false;showSkip = false;}else{if (oMediaPlayer.IsPlayingAd){showRew = false;showFwd = false;showPrev = false;showSkip = false;}else{showRew = (g_nowVideoSize == VIDEOSIZE_LARGE) && (oMediaPlayer.Player.CanScan || oMediaPlayer.Player.CanSeek) ;showFwd = (g_nowVideoSize == VIDEOSIZE_LARGE) && (oMediaPlayer.Player.CanScan || oMediaPlayer.Player.CanSeek);showPrev = (oPlaylist.Position > 0);showSkip = (oPlaylist.Position < oPlaylist.Items.length-1);}}this.Rew.style.display = (showRew) ? "inline" : "none";  this.Fwd.style.display = (showFwd) ? "inline" : "none";  this.Prev.style.display = (showPrev) ? "inline" : "none";  this.Next.style.display = (showSkip) ? "inline" : "none";if((nowFocusOb==this.Rew || nowFocusOb==this.Fwd || nowFocusOb==this.Prev || nowFocusOb==this.Next)&&(nowFocusOb.style.display == "none")&&(this.Div.style.visibility != "hidden")){if (showSkip) this.Next.focus();else if (showPrev) this.Prev.focus();else if (showFwd) this.Fwd.focus();else if (showRew) this.Rew.focus();else this.Stop.focus();}}catch (error){}}function _vcPlayingView(){this.Div.className = "vcDiv vcDivPlaying";this.FullScreenBtn.style.display = "inline";this.NormalViewBtn.style.display = "none";this.Mute.style.display = "none";this.UnMute.style.display = "none";this.Play.style.display = "inline";this.Pause.style.display = "inline";this.Stop.style.display = "inline";this.Rew.style.display = "none";this.Fwd.style.display = "none";this.Prev.style.display = "inline";this.Next.style.display = "inline";}function _vcFullScreenView(){this.Div.className = "vcDiv vcDivFullScrn";this.FullScreenBtn.style.display = "none";this.NormalViewBtn.style.display = "inline";this.RefreshMute();this.Play.style.display = "inline";this.Pause.style.display = "inline";this.Stop.style.display = "inline";this.Rew.style.display = "inline";this.Fwd.style.display = "inline";this.Prev.style.display = "inline";this.Next.style.display = "inline";}function _vcShow(){this.Div.style.visibility = "visible";this.HideShowBtns();}function _vcHide(){this.Div.style.visibility = "hidden";}function _vcIsSelectable(){return (this.Div.style.visibility != "hidden");}function _vcClickMute(){oMediaPlayer.Player.Mute = !oMediaPlayer.Player.Mute;oVideoControls.RefreshMute();if (oMediaPlayer.Player.Mute)oVideoControls.UnMute.focus();elseoVideoControls.Mute.focus();}function _vcRefreshMute(){if (oMediaPlayer.Player.Mute){this.Mute.style.display = "none";this.UnMute.style.display = "inline";}else{this.Mute.style.display = "inline";this.UnMute.style.display = "none";}}function _vcClickPlay(){switch (oMediaPlayer.GetPlayState()){case PLAYSTATE_PLAYING:break;case PLAYSTATE_PAUSED:case PLAYSTATE_FWD:case PLAYSTATE_REW:case PLAYSTATE_STOPPED:oMediaPlayer.Play();refreshPlaystateFeedback();break;default:if (oPlaylist.Position == -1)oPlaylist.Position = 0;playCurrent();break;}}function _vcClickPause(){if (oMediaPlayer.GetPlayState() == PLAYSTATE_PAUSED){oMediaPlayer.Play();}else{try{oMediaPlayer.Pause();}catch (error){}}}function _vcClickStop(){window.clearTimeout(g_clipLoadTimer);if (oMediaPlayer.IsLoading){oMediaPlayer.Cancel();oMediaPlayer.IsLoading = false;}else if (oMediaPlayer.GetPlayState() == PLAYSTATE_STOPPED){}else{try{if (oMediaPlayer.GetPlayState() != PLAYSTATE_BUFFERING) g_ForceFullStop = true;oMediaPlayer.Stop();oMediaPlayer.SetMediaPosition(0);oBrandingArea.Refresh();oVideoMetadata.Refresh(true);oNowPlaying.Refresh(true);}catch (error){}}}function _vcClickRew(){oMediaPlayer.Rew();}function _vcClickFwd(){oMediaPlayer.Fwd();}function _vcClickPrev(){playItemAfterAd(oPlaylist.Position-1);}function _vcClickNext(){if (oPlaylist.Position+1 < oPlaylist.Items.length){g_ForceFullStop = true;oMediaPlayer.Stop();oPlaylist.MoveNext();playCurrent();}else{}}function VideoMetadata(div, innerDiv) {this.Div = div;this.InnerDiv = innerDiv;this.Init = _vmInit;this.Refresh =  _vmRefresh;this.Clear = _vmClear;this.Hide = _vmHide;this.Show = _vmShow;this.IsSelectable = _vmIsSelectable;this.GetSelectableOb = _vmGetSelectableOb;}function _vmInit(){}function _vmRefresh(userStopped){this.Clear();if(oPlaylist.GetCurrent() == null)return;if (userStopped){var txt = addSpan(this.InnerDiv);txt.innerHTML = "You have stopped the video. <p/> Choose Play to begin again.";txt.className = "vmTxt1";this.SelectableOb = null;}else if (oMediaPlayer.IsPlayingAd){var txt = addSpan(this.InnerDiv);txt.innerHTML = "Up next after this advertisement:";txt.className = "vmTxt1";txt = addSpan(this.InnerDiv);txt.innerHTML = oPlaylist.GetCurrent().Title;txt.className = "vmTxt2";this.SelectableOb = null;}else{if (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING){var title = addSpan(this.InnerDiv);title.innerHTML = oPlaylist.GetCurrent().Title;title.className = "vmTxt3";var abstract = addSpan(this.InnerDiv);abstract.innerHTML = oPlaylist.GetCurrent().Caption;abstract.className = "vmTxt4";var urls = oPlaylist.GetCurrent().LinkUrls;var text = oPlaylist.GetCurrent().LinkText;var addedLink = false;for (var i=0; i<text.length; i++){if (text[i] != "" && urls[i]!=""){var arrow = addSpan(this.InnerDiv);arrow.innerHTML = bulletImage();arrow.className = "vmArrw";var link = addSpan(this.InnerDiv);link.innerHTML = text[i];InitNavObject(link,"vmLink" + i,"vmLink","","","","","","","clickRelatedLink('" + urls[i] + "', " + (i+1) + ")");if (addedLink == false){addedLink = true;this.SelectableOb = link;}}}}else{var txt = addSpan(this.InnerDiv);txt.innerHTML = "Please wait while we get your video ready.";txt.className = "vmTxt1";this.SelectableOb = null;}}}function _vmClear(){clearChildren(this.InnerDiv);}function _vmShow(){this.Div.style.visibility = "visible";}function _vmHide(){this.Div.style.visibility = "hidden";}function _vmIsSelectable(){return ((this.Div.style.visibility != "hidden") && (this.SelectableOb != null));}function _vmGetSelectableOb(){return this.SelectableOb;}function AdManager(div) {this.Div = div;this.Init = _amInit;this.SetPageGroup = _amSetPageGroup;this.LoadNext = _amLoadNext;this.SetDefaults = _amSetDefaults;this.ShowLeaveBehind = _amShowLeaveBehind;this.MapPageGroup = _amMapPageGroup;this.CurrentUrl = "";this.GetClickThroughUrl = _amGetClickThroughUrl;this.IsSelectable = _amIsSelectable;this.SelectableOb = _amSelectableOb;this.SetPos = _amSetPos;this.Show = _amShow;this.Hide = _amHide;this.Debug = _amDebug;var i = location.search.toLowerCase().indexOf("forcepagegroup=");this.ForcePageGroup = (i != -1) ? location.search.substring(i+15,i+21) : null;this.defaultImgSrc = "/Images/MSNVideo/default_120x30_ad.gif";this.defaultImgHref = "http://msnbc.msn.com";this.PROMOTIONAL_PG = this.MapPageGroup("MSVPR1");this.SENSITIVE_PG = this.MapPageGroup("MSVSCB");this.NOAD_PG = this.MapPageGroup("MSVNPB");this.MARKETING_PG = this.MapPageGroup("MSVBSB");this.Enabled = false;}function _amInit(imageWidth, imageHeight, playAdFirst){this.AdImg = addImg(this.Div);this.AdImg.width = imageWidth;this.AdImg.height = imageHeight;this.AdImg.src = "/Images/Shared/s.gif";this.AdImg.onerror = _amOnImgFailure;this.PageGroupToUse = this.MARKETING_PG;this.EndUserSees = "image";this.AdFlag = (playAdFirst == "false") ? false : true;}function _amSetPageGroup(contentPG){var sourcePG = this.MapPageGroup(contentPG);switch (sourcePG){case this.PROMOTIONAL_PG:this.PageGroupToUse = this.AdFlag ? sourcePG : this.MARKETING_PG;this.EndUserSees = this.AdFlag ? "video" : "image";this.AdFlag = true;  break;case this.SENSITIVE_PG:this.PageGroupToUse = this.SENSITIVE_PG;this.EndUserSees = "image";this.AdFlag = true;break;case this.NOAD_PG:this.PageGroupToUse = this.MARKETING_PG;this.EndUserSees = "image";this.AdFlag = true;break;default:  this.PageGroupToUse = this.AdFlag ? sourcePG : this.MARKETING_PG;this.EndUserSees = this.AdFlag ? "video" : "image";this.AdFlag = this.AdFlag ? false : true;}if (!this.Enabled)this.EndUserSees = "image";}function _amLoadNext(){this.ReceivedResponse = false;this.AdImg.src = "/Images/Shared/s.gif";if (this.ForcePageGroup != null)this.PageGroupToUse = this.ForcePageGroup;this.CurrentUrl = urlToAdData(this.PageGroupToUse);oDataFetcher.GetData(this.CurrentUrl, onLoadAd, onLoadAdFail);this.LoadTimer = window.setTimeout(_amCheckLoadStatus, 5000);}function _amCheckLoadStatus(){window.clearTimeout(oAdManager.InitTimer);if (!oAdManager.ReceivedResponse){oDataFetcher.Cancel(oAdManager.CurrentUrl);oAdManager.SetDefaults();onLoadAdComplete();}}function onLoadAd(){oAdManager.ReceivedResponse = true;try{eval(oDataFetcher.Data);if (t_adImgSrc == null){onLoadAdFail();}else{oAdManager.AdImageSrc = t_adImgSrc;oAdManager.AdImageHref = t_adImgHref;oAdManager.TrackingImgSrc = t_trackingImgSrc;oAdManager.TrackingImgId = t_trackingImgId;oAdManager.ClipSrc = t_clipSrc;}}catch (exception){onLoadAdFail();}onLoadAdComplete();}function onLoadAdFail(){oAdManager.SetDefaults();}function _amSetDefaults(){this.AdImageSrc = this.defaultImgSrc;this.AdImageHref = this.defaultImgHref;this.TrackingImgSrc = "";this.TrackingImgId = "";this.ClipSrc = "";}function _amShowLeaveBehind(){if ((this.AdImageSrc == null || this.AdImageSrc == "") || (this.AdImageHref == null || this.AdImageHref == "")){this.AdImageSrc = this.defaultImgSrc;this.AdImageHref = this.defaultImgHref;}this.AdImg.src = this.AdImageSrc;var img = new Image();img.src = this.TrackingImgSrc;}function _amOnImgFailure(){oAdManager.AdImg.src = oAdManager.defaultImgSrc;oAdManager.AdImageHref = oAdManager.defaultImgHref;}function _amGetClickThroughUrl(){return this.AdImageHref;}function _amSetPos(top, left){this.Div.style.top = top;this.Div.style.left = left;}function _amShow(){this.Div.style.visibility = "visible";}function _amHide(){this.Div.style.visibility = "hidden";}function _amIsSelectable(){return (this.AdImageSrc != null && this.AdImageSrc != "");}function _amSelectableOb(){return this.Div;}function _amMapPageGroup(msntvPg){switch (msntvPg){case "MSVROM" : return "WTVRO6";case "MSVNPB" : return "WTVTVM";case "MSVBSB" : return "MSVTV3";case "MSVSCB" : return "MSVTV4";case "MSVPR1" : return "WTVTV1";case "MSVPR2" : return "MSVTV2";case "MSVSPO" : return "MSVTV5";case "MSVDNB" : return "MSVTV6";case "MSVDYM" : return "MSVTV7";case "MSVFNM" : return "MSVTVF";case "MSVFLM" : return "MSVTV8";case "MSVHGM" : return "MSVTV9";case "MSVTWM" : return "NBCTVW";case "MSVTOM" : return "NBCTVO";case "MSVTCM" : return "NBCTVC";case "MSVTPM" : return "NBCTVE";default: return "WTVRO6";}}function _amDebug(){}function BacklistManager() {this.Items = new Array();this.Append = _bmAppend;this.RemoveLast = _bmRemoveLast;}function _bmAppend(topicInd, catInd, videoSize, navView){if ((navView==null) || (videoSize==null))return;if (this.Items.length > 0){var i = this.Items[this.Items.length-1];if (i[0]==topicInd && i[1]==catInd && i[2]==videoSize && i[3]==navView){return;}if (i[0]==topicInd && i[1]==catInd && i[2]==videoSize && i[3]==navView){return;}}this.Items[this.Items.length] = new Array(topicInd, catInd, videoSize, navView);}function _bmRemoveLast(){var a = new Array();for (var i=0; i< this.Items.length-1; i++){a[i] = this.Items[i];}this.Items = a;}function DataFetcher(){this.Init = _dfInit;this.GetData = _dfGetData;this.OnLoad = _dfOnLoad;this.Cancel = _dfCancel;this.AppendToQueue = _dfAppendToQueue;this.PushToQueue = _dfPushToQueue;this.ClearQueue = _dfClearQueue;this.DomDoc = new ActiveXObject("Msxml2.DOMDocument");this.DomDoc.onreadystatechange = _dfCheckReadyState;this.DomDoc.async = true;}function _dfInit(){this.UrlQueue = new Array();this.OnSucceedQueue = new Array();this.OnFailQueue = new Array();}function _dfGetData(url, onSucceed, onFail){if (this.Url != null){this.PushToQueue(this.Url, this.OnSucceed, this.OnFail);}this.Url = url;this.OnSucceed = onSucceed;this.OnFail = onFail;this.DomDoc.load(url);}function _dfOnLoad(){this.Data = this.DomDoc.text;var f = (this.DomDoc.parseError.errorCode != 0) ? this.OnFail : this.OnSucceed;this.Url = null;this.OnSucceed = null;this.OnFail = null;f.call();if (this.UrlQueue.length != 0){this.GetData(this.UrlQueue[0], this.OnSucceedQueue[0], this.OnFailQueue[0]);var a1 = new Array();var a2 = new Array();var a3 = new Array();for (var i=0; i<this.UrlQueue.length-1; i++){a1[i] = this.UrlQueue[i+1];a2[i] = this.OnSucceedQueue[i+1];a3[i] = this.OnFailQueue[i+1];}this.UrlQueue = a1;this.OnSucceedQueue = a2;this.OnFailQueue = a3;}}function _dfAppendToQueue(url, onSucceed, onFail){var i = this.UrlQueue.length;this.UrlQueue[i] = url;this.OnSucceedQueue[i] = onSucceed;this.OnFailQueue[i] = onFail;}function _dfPushToQueue(url, onSucceed, onFail){var a1 = new Array(this.Url);var a2 = new Array(this.OnSucceed);var a3 = new Array(this.OnFail);for (var i=0; i<this.UrlQueue.length; i++){a1[i+1] = this.UrlQueue[i];a2[i+1] = this.OnSucceedQueue[i];a3[i+1] = this.OnFailQueue[i];}this.UrlQueue = a1;this.OnSucceedQueue = a2;this.OnFailQueue = a3;}function _dfClearQueue(){this.UrlQueue = new Array();this.OnSucceedQueue = new Array();this.OnFailQueue = new Array();this.Url = null;this.OnSucceed = null;this.OnFail = null;this.DomDoc.abort();}function _dfCheckReadyState(){if (oDataFetcher.DomDoc.readyState==4){if (oDataFetcher.DomDoc.url == oDataFetcher.Url){oDataFetcher.OnLoad();}}}function _dfCancel(url){}var PLAYLIST_MAX = 1000;var g_nowNavView;var NAV_VIEW_HOME = 0;var NAV_VIEW_BROWSE = 1;var NAV_VIEW_PLAYLIST = 2;var g_nowTopicInd = -1;var g_nowCatInd = -1;var g_bBlockInput = false;var g_types;var g_GUIDs;var g_PGs;var g_PSs;var g_IDs;var g_sources;var g_headlines;var g_captions;var g_imageTypes;var g_imageUrls;var g_videoPaths;var g_articleUrls;var g_relatedLinkUrls;var g_relatedLinkText;function setMetaDataGlobals(types, GUIDs, PGs, PSs, IDs, sources, headlines, captions, imageTypes, imageUrls, videoPaths, articleUrls, relatedLinkUrls, relatedLinkText){g_types = (types != null) ? types : new Array();g_GUIDs = (GUIDs != null) ? GUIDs : new Array();g_PGs = (PGs != null) ? PGs : new Array();g_PSs = (PSs != null) ? PSs : new Array();g_IDs = (IDs != null) ? IDs : new Array();g_sources = (sources != null) ? sources : new Array();g_headlines = (headlines != null) ? headlines : new Array();g_captions = (captions != null) ? captions : new Array();g_imageTypes = (imageTypes != null) ? imageTypes : new Array();g_imageUrls = (imageUrls != null) ? imageUrls : new Array();g_videoPaths = (videoPaths != null) ? videoPaths : new Array();g_articleUrls = (articleUrls != null) ? articleUrls : new Array();g_relatedLinkUrls = (relatedLinkUrls != null) ? relatedLinkUrls : new Array();g_relatedLinkText = (relatedLinkText != null) ? relatedLinkText : new Array();}function catHasClipsNotInPlaylist(){var t_GUIDs = new Array();var j = 0;for (var i=g_GUIDs.length-1; i>=0; i--){if (g_videoPaths[i] != ""){t_GUIDs[j] = g_GUIDs[i];j++;}}var clipsToAdd = false;for (var i=0; i<t_GUIDs.length; i++){if (oPlaylist.IndexOf(t_GUIDs[i]) == -1)clipsToAdd = true;}return clipsToAdd;}function addCategoryToPlaylist(){var t_GUIDs = new Array();var t_videoPaths = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_sources = new Array();var t_relatedLinkUrls = new Array();var t_relatedLinkText = new Array();var t_PGs = new Array();var t_PSs = new Array();var t_IDs = new Array();var j = 0;for (var i=g_GUIDs.length-1; i>=0; i--){if (g_videoPaths[i] != ""){t_GUIDs[j] = g_GUIDs[i];t_videoPaths[j] = g_videoPaths[i];t_headlines[j] = g_headlines[i];t_captions[j] = g_captions[i];t_imageUrls[j] = g_imageUrls[i];t_sources[j] = g_sources[i];t_relatedLinkUrls[j] = g_relatedLinkUrls[i];t_relatedLinkText[j] = g_relatedLinkText[i];t_PGs[j] = g_PGs[i];t_PSs[j] = g_PSs[i];t_IDs[j] = g_IDs[i];j++;}}oPlaylist.AddAll(t_GUIDs, t_videoPaths, t_headlines, t_captions, t_imageUrls, t_sources, t_relatedLinkUrls, t_relatedLinkText, t_PGs, t_PSs, t_IDs);}var p_types = new Array();var p_titles = new Array();var p_slideHtml = new Array();var p_abstractHtml = new Array();var p_metdataHtml = new Array();var p_userWeatherCity;var p_userWeatherConditionImg;var p_stockDirection;function setPersonalDataGlobals(types, titles, slideHtml, abstractHtml, metdataHtml, userWeatherCity, userWeatherConditionImg, stockDirection){p_types = types;p_titles = titles;p_slideHtml = slideHtml;p_abstractHtml = abstractHtml;p_metdataHtml = metdataHtml;p_userWeatherCity = userWeatherCity;p_userWeatherConditionImg = userWeatherConditionImg;p_stockDirection = stockDirection;}function addPersonalDataToGlobals(){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];var newType = "";if ((topicName == "Weather") && (p_userWeatherCity!=null)){newType = "Weather";}if (newType != ""){for (var i=g_types.length; i>0; i--){g_types[i] = g_types[i-1];g_GUIDs[i] = g_GUIDs[i-1];g_PGs[i] = g_PGs[i-1];g_PSs[i] = g_PSs[i-1];g_IDs[i] = g_IDs[i-1];g_sources[i] = g_sources[i-1];g_headlines[i] = g_headlines[i-1];g_captions[i] = g_captions[i-1];g_imageTypes[i] = g_imageTypes[i-1];g_imageUrls[i] = g_imageUrls[i-1];g_videoPaths[i] = g_videoPaths[i-1];g_articleUrls[i] = g_articleUrls[i-1];g_relatedLinkUrls[i] = g_relatedLinkUrls[i-1];g_relatedLinkText[i] = g_relatedLinkText[i-1];}g_types[0] = newType;g_GUIDs[0] = "";g_videoPaths[0] = "";}}function addSlideshowToPlaylist(firstInd){var a = (firstInd==null) ? 0 : firstInd;var t_GUIDs = new Array();var t_videoPaths = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_sources = new Array();var t_relatedLinkUrls = new Array();var t_relatedLinkText = new Array();var t_PGs = new Array();var t_PSs = new Array();var t_IDs = new Array();var j = 0;for (var i=g_scGuids.length-1; i>=0; i--){if (i!=a){t_GUIDs[j] = g_scGuids[i];t_videoPaths[j] = g_scVideoUrls[i];t_headlines[j] = g_scHeadlines[i];t_captions[j] = g_scCaptions[i];t_imageUrls[j] = g_scImageUrls[i];t_sources[j] = g_scSources[i];t_relatedLinkUrls[j] = g_scRelatedLinkUrls[i];t_relatedLinkText[j] = g_scRelatedLinkText[i];t_PGs[j] = g_scPGs[i];t_PSs[j] = g_scPSs[i];t_IDs[j] = g_scIDs[i];j++;}}oPlaylist.AddAll(t_GUIDs, t_videoPaths, t_headlines, t_captions, t_imageUrls, t_sources, t_relatedLinkUrls, t_relatedLinkText, t_PGs, t_PSs, t_IDs);oPlaylist.PutNext(g_scGuids[a], g_scVideoUrls[a], g_scHeadlines[a], g_scCaptions[a], g_scImageUrls[a], g_scSources[a], g_scRelatedLinkUrls[a], g_scRelatedLinkText[a], g_scPGs[a], g_scPSs[a], g_scIDs[a]);}function handleThumbClick(ind, isLoading){var i = (ind + oNavBar.CurrentRatchet) % oNavBar.HTML.length;if (g_types[i] == "Weather"){showWeather();return;}if (g_types[i] == "Stocks"){showStocks();return;} var inPlaylistAtPos = oPlaylist.IndexOf(g_GUIDs[i]); var isPlaying = (oMediaPlayer.GetPlayState() == PLAYSTATE_PLAYING); var currentItemIsAd = oMediaPlayer.IsPlayingAd;if (inPlaylistAtPos != -1){if (currentItemIsAd){oMessagePopup.AutoHide("The selected video will play after the advertisement");playItemAfterAd(inPlaylistAtPos);return;}if (inPlaylistAtPos == oPlaylist.Position){if (isLoading){oMessagePopup.AutoHide("The selected video is currently loading");return;}else if (isPlaying){oMessagePopup.AutoHide("The selected video is currently playing");return;}}oMessagePopup.AutoHide("Preparing to play the selected video");playItemAfterAd(inPlaylistAtPos);return;}if (!oPlaylist.PutLast(g_GUIDs[i], g_videoPaths[i], g_headlines[i], g_captions[i], g_imageUrls[i], g_sources[i], g_relatedLinkUrls[i], g_relatedLinkText[i], g_PGs[i], g_PSs[i], g_IDs[i]))return;onPlayListChange();if (isLoading || isPlaying){oMessagePopup.AutoHide("Adding the selected video to the playlist");return;}oMessagePopup.AutoHide("Preparing to play the selected video");playItemAfterAd(oPlaylist.Items.length-1);}function getTopic_Cat(topicInd, catInd){return (catInd==-1) ? topicInd : topicInd + "_" + catInd;}function ImagePreloader() {this.Init = _ipInit;this.Start = _ipStart;this.GetNext = _ipGetNext;this.ImageOb = new Image();this.ImageOb.onload = function(){ oImagePreloader.GetNext() };this.LoadFunction = function(){ oImagePreloader.ImageOb.src = oImagePreloader.Images[oImagePreloader.NowInd]; };this.TimerId = null;}function _ipInit(imageArray){this.Images = imageArray;}function _ipStart(){this.NowInd = -1;this.GetNext();}function _ipGetNext(){window.clearTimeout(this.TimerId);this.NowInd++;if (this.NowInd <= this.Images.length-1){this.TimerId = window.setTimeout(this.LoadFunction, 1);}}function JsPreloader() {this.Init = _jsInit;this.Load = _jsLoad;this.LoadNext = _jsLoadNext;this.Urls = new Array();this.NowLoading = -1;}function _jsInit(topicIds, catIds, client){this.TopicIds = topicIds;this.CatIds = catIds;this.Client = client;}function _jsLoad(nowTopicInd, nowCatInd){this.Urls = new Array();this.NowLoading = -1;this.NowTopic = nowTopicInd;this.NowCat = nowCatInd;var idArray = new Array();if (nowTopicInd == -1){idArray = this.TopicIds;}else if (nowCatInd == -1){idArray = this.CatIds[nowTopicInd];}if (idArray != null){for (var i=0; i<idArray.length; i++){this.Urls[i] = urlToJsLoader(idArray[i], this.Client);}}this.LoadNext();}function _jsLoadNext(){var i = this.NowLoading + 1;if (i < this.Urls.length){this.NowLoading = i;oDataFetcher.GetData(this.Urls[i], _jsOnLoad, _jsOnLoadFail);  }}function _jsOnLoad(){if (oDataFetcher.Data == ""){if (oJsPreloader.NowTopic != -1){var badCat = getTopic_Cat(oJsPreloader.NowTopic, oJsPreloader.NowLoading);oCategoryChooser.AppendBadCat(badCat);}}oJsPreloader.LoadNext();}function _jsOnLoadFail(){oJsPreloader.LoadNext();}var kUP = 0;var kDOWN = 1;var kLEFT = 2;var kRIGHT = 3;var nowFocusOb;function InitNavObject(ob, obId, cssClass, cssClassHilite, overAction, upAction, downAction, leftAction, rightAction, clickAction){ob.id = obId;ob.Class = cssClass;ob.HiliteClass = cssClassHilite;ob.OverAction = overAction;ob.UpAction = upAction;ob.DownAction = downAction;ob.LeftAction = leftAction;ob.RightAction = rightAction;ob.ClickAction = clickAction;ob.onclick = ObClick;ob.onfocus= ObFocus;ob.onmouseover = ObFocus;ob.Blur = ObBlur;ob.SetHighlight = ObSetHighlight;ob.SetHighlight(false);}function ObFocus(){if (this == nowFocusOb)return;if (nowFocusOb != null)nowFocusOb.Blur();nowFocusOb = this;if (this.OverAction != null)eval(this.OverAction);this.style.border = 2;this.style.borderStyle = "solid";this.style.borderColor = "yellow";return true;}function ObBlur(){if (this.OffAction != null)eval(this.OffAction);this.style.border = 0;this.style.borderColor = "";}function ObClick(){eval(this.ClickAction);}function ObSetHighlight(hilite){this.Highlighted = hilite;if (hilite)this.className = (this.HiliteClass != null) ? this.HiliteClass : this.Class;elsethis.className = this.Class;}function DirAction(dir){var a = "";if (dir==kUP){a = nowFocusOb.UpAction;}else if (dir==kDOWN){a = nowFocusOb.DownAction;}else if (dir==kLEFT){a = nowFocusOb.LeftAction;}else if (dir==kRIGHT){a = nowFocusOb.RightAction;}if (a != ""){eval(a);return true;}return false;}document.GoBack = videoGoBack;function onRemoteEvent(ob, keyChar){if (g_bBlockInput)return true;if (g_nowVideoSize == VIDEOSIZE_FULL)return videoGoBack();if (g_nowVideoSize == VIDEOSIZE_LARGE)startFsCountdown();switch (keyChar){case 0x26:  return DirAction(kUP);case 0x28:return DirAction(kDOWN);case 0x25:return DirAction(kLEFT);case 0x27:return DirAction(kRIGHT);case 0x08:return true;case 0x6B:return true;    case 0x6D:return true;case 0x0D:nowFocusOb.click();return true;default:return false;}}function Playlist() {this.Items = new Array();this.Init = _plInit;this.PutNext = _plPutNext;this.PutLast = _plPutLast;this.Insert = _plInsert;this.Remove = _plRemove;this.AddAll = _plAddAll;this.RemoveAll = _plRemoveAll;this.IndexOf = _plIndexOf;this.GetCurrent = _plGetCurrent;this.MoveNext = plMoveNext;this.MoveTo = plMoveTo;this.OK = 0;this.DUPE = 1;this.MAX = 2;}function _plInit(maxLength){this.Position = -1;this.MaxLength = maxLength;onPlayListChange();}function plMoveNext(){if (this.Position < this.Items.length-1){this.Position++;onPlayListChange();}}function plMoveTo(ind){if (ind <= this.Items.length){this.Position = ind;onPlayListChange();}}function _plPutNext(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){var item = new PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id);return (this.Insert(item, this.Position+1) == this.OK);}function _plPutLast(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){var item = new PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id);return (this.Insert(item, this.Items.length) == this.OK);}function _plAddAll(guids, urls, titles, captions, thumbs, sources, linkUrls, linkText, pageGroups, pss, ids){var item;for (var i=0; i< guids.length; i++){item = new PlaylistItem(guids[i], urls[i], titles[i], captions[i], thumbs[i], sources[i], linkUrls[i], linkText[i], pageGroups[i], pss[i], ids[i]);if (this.Insert(item, this.Position+1) == this.MAX) return;}}function _plInsert(item, ind){var inPlaylistAtPos = this.IndexOf(item.GUID);if (this.Items.length < this.MaxLength){for (var i=this.Items.length; i>ind; i--){this.Items[i] = this.Items[i-1];} this.Items[ind] = item;if (inPlaylistAtPos != -1){if (inPlaylistAtPos <= ind){this.Remove(inPlaylistAtPos);if (this.Position > 0)this.Position = this.Position-1;}else{this.Remove(inPlaylistAtPos+1);}}return this.OK;}oMessagePopup.Warning("The video was not added to your playlist because your list is full. The maximum number of videos your playlist can contain is " + this.MaxLength + ".", "");return this.MAX;}function _plRemove(ind){var tmpArr = new Array();var tmpInd = 0;for (var i=0; i<this.Items.length; i++){if (i!=ind){tmpArr[tmpInd++] = this.Items[i];}} this.Items = tmpArr;onPlayListChange();}function _plRemoveAll(){this.Items = new Array();this.Position = -1;onPlayListChange();}function _plIndexOf(guid){for(var i=0;i<this.Items.length;i++){var testGuid = this.Items[i].GUID;if (testGuid !== null && testGuid==guid)return i;}return -1;}function _plGetCurrent(){try{return this.Items[this.Position];}catch (e){return null;}}function PlaylistItem(guid, url, title, caption, thumb, source, linkUrls, linkText, pageGroup, ps, id){this.GUID = guid;this.URL = url;this.Title = title;this.Caption = caption;this.Thumb = thumb;this.Source = source;this.LinkUrls = linkUrls;this.LinkText = linkText;this.PageGroup = pageGroup;this.PS = ps;this.ID = id;}function TrackingManager(div) {this.Div = div;this.Init = _tmInit;this.TrackContentPlay = _tmTrackContentPlay;this.TrackAdPlay = _tmTrackAdPlay;this.TrackRelatedLink = _tmTrackRelatedLink;this.TrackPageView = _tmTrackPageView;}function _tmInit(client){switch (client){case "MCE":this.ClientId = "67531";break;case "Anduril":this.ClientId = "68206";break;default:this.ClientId = "";}this.ContentC = addImg(this.Div);this.ContentC.src = "/Images/Shared/s.gif";this.ContentG = addImg(this.Div);this.ContentG.src = "/Images/Shared/s.gif";this.AdG = addImg(this.Div);this.AdG.src = "/Images/Shared/s.gif";this.PageViewC = addImg(this.Div);this.PageViewC.src = "/Images/Shared/s.gif";}function _tmTrackContentPlay(item){var cUrl= "http://c.msn.com/c.gif?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=82594";var gUrl= "http://g.msn.com/0VD0/34/62?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=" + item.PS+ "&CM=source_" + item.Source+ "&CE=content"+ "&HL=" + item.ID;this.ContentC.src = cUrl;this.ContentG.src = gUrl;}function _tmTrackAdPlay(plItem, adId){var CEval = (adId == "") ? "commercial" : "no_ad";  var url = "http://g.msn.com/0VD0/34/62?"+ "DI=2622"+ "&PI=" + this.ClientId+ "&PS=" + plItem.PS+ "&CM=ad_" + plItem.PageGroup+ "&CE=" + CEval+ "&HL=" + plItem.GUID;this.AdG.src = url;}function _tmTrackRelatedLink(destUrl, linkPos, plItem){return destUrl;}function _tmTrackPageView(){var url = "http://c.msn.com/c.gif?"+ "DI=1455"+ "&PI=" + this.ClientId+ "&PS=73424"+ "&TP=http%3A//msntv.msn.com/pages/msnvideo/main.aspx";this.PageViewC.src = url;}function drawInitialView(){switch (getInitialView()){case "loadPlaylist":var url = urlToPlaylistData(g_startUpParams);oDataFetcher.GetData(url, onGetPlaylist, onGetPlaylistFail);break;case "guidLookup":var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);break;case "openToCat":DeviceSpecialStart();break;default:DeviceDefaultStart();break;}}function getInitialView(){if (g_startUpParams==null)return "default";if (getStartupParam("p")!="")return "loadPlaylist";if ((getStartupParam("g")!="") || (getStartupParam("i")!="") || (getStartupParam("r")!="") || (getStartupParam("prepend")!="") || (getStartupParam("replace")!=""))return "guidLookup";if ((getStartupParam("m")!="") || (getStartupParam("mi")!="") || (getStartupParam("menu")!="") || (getStartupParam("menuItem")!=""))return "openToCat";return "default";}var STARTUP_PARAMS = "msnVideoStartupParams";function getStartupParamsCookie(){return getCookie(STARTUP_PARAMS);}function clearStartupParamsCookie(){setCookie(STARTUP_PARAMS,"",0);}function onGetPlaylist(){try{if (oDataFetcher.Data == ""){onGetPlaylistFail();}else{eval(oDataFetcher.Data);var item;for (var i=t_GUIDs.length-1; i>=0 ; i--){item = new PlaylistItem(t_GUIDs[i], t_videoPaths[i], t_headlines[i], t_captions[i], t_imageUrls[i], t_sources[i], t_relatedLinkUrls[i], t_relatedLinkText[i], t_PGs[i], t_PSs[i], t_IDs[i]);if (oPlaylist.Insert(item, 0) != oPlaylist.OK)return;}var startItemGuid = getStartupParam("i");if (startItemGuid == "") startItemGuid = getStartupParam("g");if (startItemGuid != ""){var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);}else{DeviceSpecialStart();}}}catch (e){onGetPlaylistFail();}}function onGetPlaylistFail(){if ((getStartupParam("g")!="") || (getStartupParam("i")!="") || (getStartupParam("r")!="") || (getStartupParam("prepend")!="") || (getStartupParam("replace")!="")){var url = urlToGuidLookup(g_startUpParams);oDataFetcher.GetData(url, onGetItemByGuid, onGetItemByGuidFail);}else{DeviceDefaultStart();}}function onGetItemByGuid(){try{if (oDataFetcher.Data == ""){onGetItemByGuidFail();return;}eval(oDataFetcher.Data);var item;for (var i=t_GUIDs.length-1; i>=0 ; i--){item = new PlaylistItem(t_GUIDs[i], t_videoPaths[i], t_headlines[i], t_captions[i], t_imageUrls[i], t_sources[i], t_relatedLinkUrls[i], t_relatedLinkText[i], t_PGs[i], t_PSs[i], t_IDs[i]);if (oPlaylist.Insert(item, 0) != oPlaylist.OK)return;}DeviceSpecialStart();}catch (oError){onGetItemByGuidFail();}}function onGetItemByGuidFail(){DeviceDefaultStart();}function getInitialNavView(){var t_topicName = (getStartupParam("m")!="") ? getStartupParam("m") : getStartupParam("menu");var t_categoryName = (getStartupParam("mi")!="") ? getStartupParam("mi") : getStartupParam("menuItem");if (t_topicName!= null){var loadCategory = false;var initTopic = -1;var initCat = -1;for (var a=0; a<g_topics.length; a++){if (g_topics[a]==t_topicName){loadCategory = true;initTopic = a;}if (loadCategory && t_categoryName!=null && t_categoryName!=""){for (var b=0; b<g_cats[a].length; b++){if (g_cats[a][b]==t_categoryName) {initCat = b;break;}}}if (loadCategory)break;}if (loadCategory){g_nowTopicInd = initTopic;g_nowCatInd = initCat;return NAV_VIEW_BROWSE;}}if (getInitialView() == "loadPlaylist"){return NAV_VIEW_PLAYLIST;}return NAV_VIEW_HOME;}function getStartupParam(name){var re = /\+/g;var value = "";if (g_startUpParams != null && g_startUpParams != ""){var p = g_startUpParams.split("&");for (var i=0; i<p.length; i++){var nv = p[i].split("=");if (nv[0] == name){value = unescape(nv[1]);return value.replace(re, " ");}}}return value;}function addSpan(ob){var newSpan = document.createElement("SPAN");return ob.appendChild(newSpan);}function addImg(ob){var newSpan = document.createElement("IMG");return ob.appendChild(newSpan);}function addSwf(ob){var childOb = document.createElement("EMBED");return ob.appendChild(childOb);}function addIFrame(ob){var i = document.createElement("IFRAME");return ob.appendChild(i);}function clearChildren(ob){var child;for (var i=ob.children.length; i>0; i--){child = ob.children(i-1);ob.removeChild(child);}}function addDiv(ob){var newDiv = document.createElement("DIV");return ob.appendChild(newDiv);}function imageTag(src, w, h, className){var tag = "<img src='" + src + "'";if (w!="")tag += " width='" + w + "'";if (h!="")tag += " height='" + h + "'"; if (className!="")tag += " class='" + className + "'";tag += "/>";return tag; }function okToLeaveApp(){if (oPlaylist.Items.length <= 1)return true;elsereturn oMessagePopup.Confirm("Are you sure you want to leave MSN Video? When you leave, your playlist will be emptied.");}function getAppLocation(){var a = location.href;var b = a.substring(0,a.indexOf('://')+3);var c = a.substring(b.length, a.length);var d = c.substring(0,c.indexOf('/'));return b + d;}function urlToJsLoader(topicId, client){return g_appLoc + "/VideoContent.ashx?contentType=videoMetadata&client=" + client + "&topicId=" + topicId;}function urlToPersonalData(clientZip){return g_appLoc + "/PersonalizedContent.ashx?xForm=MSNVideo/DataFetcher_PersonalData.xslt&clientZip=" + clientZip;}function urlToAdData(pageGroup){return g_appLoc + "/VideoContent.ashx?contentType=ad&pg=" + pageGroup;}function urlToPlaylistData(params){return g_appLoc + "/VideoContent.ashx?contentType=playlist&" + params;}function urlToGuidLookup(params){return g_appLoc + "/VideoContent.ashx?contentType=guidLookup&" + params;}function urlToUserActivity(){return g_appLoc + "/UserActivity.ashx?";}function _utGetClosestChild(parent, x){var ob;for (var i=0; i<parent.children.length; i++){if (parent.children[i].ClickAction != null){ob = parent.children[i];var middlePoint = ob.offsetLeft + (ob.offsetWidth/2);if (x<=middlePoint)return ob;}}return ob;}function htmlDecode(s){return s.replace("&amp;", "&");}function setCookie(name, value, expMs){var now = new Date();var expires = new Date(now.valueOf() + expMs);  document.cookie = escape(name) + "=" + escape(value) + ";expires=" + expires + ";path=/";}function getCookie(name){var dc = document.cookie;var prefix = name + "=";var begin = dc.indexOf("; " + prefix);if (begin == -1){begin = dc.indexOf(prefix);if (begin != 0) return null;}else{begin += 2;}var end = document.cookie.indexOf(";", begin);if (end == -1){end = dc.length;}return unescape(dc.substring(begin + prefix.length, end));}var g_appLoc = getAppLocation();var g_nowSlideshowMode;var SLIDESHOW_OFF = 0;var SLIDESHOW_ON = 1;var g_nowVideoSize;var VIDEOSIZE_NONE = 0;var VIDEOSIZE_SMALL = 1;var VIDEOSIZE_MEDIUM = 2;var VIDEOSIZE_LARGE = 3;var VIDEOSIZE_FULL = 4;var oAdManager;var oBacklistManager;var oBanner;var oBkg1;var oBkg2;var oBrandingArea;var oBrowseHeader;var oCategoryChooser;var oDataFetcher;var oFooter;var oFullScreenPanel;var oImagePreloader;var oJsPreloader;var oMediaPlayer;var oMessagePopup;var oNavBar;var oNowPlaying;var oOnDeckArea;var oPlaylist;var oProgressBar;var oSlideShow;var oTrackingManager;var oVideoControls;var oVideoMetadata;var iSlideShowInterval = 15000;var iSlideShowTimerId = null;var iFullScreenTimerId = null;var iPlayNextTimerId = null;var iPlayAllTimerId = null;var g_startUpParams = getStartupParamsCookie();clearStartupParamsCookie();function IsMCEEnabled(){return true;}function initApp(){oAdManager = new AdManager(adManagerDiv);oBacklistManager = new BacklistManager();oBanner = new Banner(bannerDiv);oBkg1 = new Background(bkg1);oBkg2 = new Background(bkg2);oBrandingArea = new BrandingArea(brandingDiv, "brandingDiv");oBrowseHeader = new BrowseHeader(browseHeaderDiv);oCategoryChooser = new CategoryChooser(categoryChooserDiv, 12);oDataFetcher = new DataFetcher();oFooter = new Footer(footerDiv);oFullScreenPanel = new FullScreenPanel(fullScreenPanelDiv);oImagePreloader = new ImagePreloader();oJsPreloader = new JsPreloader();oMediaPlayer = new MediaPlayer(mediaPlayerDiv, MediaPlayerOCX, mpStatusDiv);oMessagePopup = new MessagePopup();oNavBar = new NavBar(navBarDiv);oNowPlaying = new NowPlaying(nowPlayingDiv);oOnDeckArea = new OnDeckArea(onDeckDiv, transitionDiv);oPlaylist = new Playlist();oProgressBar = new ProgressBar(pbDiv);oSlideShow = new SlideShow(slideShowPanel, slideShowAbstract);oTrackingManager = new TrackingManager(trackingDiv);oVideoControls = new VideoControls(videoControlsDiv);oVideoMetadata = new VideoMetadata(videoMetadataDiv, videoMetadataInnerDiv);var adFlag = getStartupParam("af");oAdManager.Init(120, 30, adFlag);oBkg1.Draw1();oBkg2.Draw2();oBanner.Init();oBrandingArea.Init();oBrowseHeader.Init();oCategoryChooser.Init(g_topics, g_cats, footerDiv.offsetTop);oDataFetcher.Init();oFullScreenPanel.Init();oJsPreloader.Init(g_topicIds, g_catIds, "Anduril");oMediaPlayer.Init();oNowPlaying.Init();oOnDeckArea.Init();oProgressBar.Init(oMediaPlayer, 69);oTrackingManager.Init("Anduril");oVideoControls.Init();oVideoMetadata.Init();oPlaylist.Init(PLAYLIST_MAX);InitNavObject(adManagerDiv,"adImg","amDiv","","","","","","","clickAd()");drawInitialView();oTrackingManager.TrackPageView();}function DeviceDefaultStart(){setVideoSize(VIDEOSIZE_NONE);setNavView(NAV_VIEW_HOME);refreshFooter();updateBacklist();oAdManager.LoadNext();}var _playAfterThumbnailLoad = false;function DeviceSpecialStart(){var t_navView = getInitialNavView();var t_playing = (oPlaylist.Items.length > 0);var t_vidSize;if (!t_playing){t_vidSize = VIDEOSIZE_NONE;}else if (t_navView == NAV_VIEW_HOME){t_vidSize = VIDEOSIZE_MEDIUM;}else{t_vidSize = VIDEOSIZE_SMALL;_playAfterThumbnailLoad = true;t_playing = false;}setVideoSize(t_vidSize);setNavView(t_navView);refreshFooter();updateBacklist();if (t_playing){oPlaylist.MoveTo(0);playCurrent();}}function setVideoSize(videoSize){if (g_nowVideoSize == videoSize)return;g_nowVideoSize = videoSize;window.clearTimeout(iFullScreenTimerId);switch (videoSize){case VIDEOSIZE_NONE:setBodyBg("131517");toggleSlideshow(SLIDESHOW_ON);oMediaPlayer.SetDimensions(0, 0, 0, 0, 0, 0, 0, 0);oAdManager.SetPos(202, 418);oAdManager.Show();oBanner.Show();oBkg1.Show();oBkg2.Hide();oBrandingArea.Hide();oBrowseHeader.Show();oCategoryChooser.Hide();oFullScreenPanel.Hide();oMediaPlayer.Hide();oNavBar.Show();oNowPlaying.Hide();oOnDeckArea.Hide();oProgressBar.Hide();oSlideShow.Show();oVideoMetadata.Hide();oVideoControls.Hide();break;case VIDEOSIZE_SMALL:setBodyBg("131517");toggleSlideshow(SLIDESHOW_OFF);oBrandingArea.SetDimensions(41, 10, 35, 243);oMediaPlayer.SetDimensions(385, 41, 160, 120, 3, 3, 3, 3);oAdManager.SetPos(171, 422);oAdManager.Show();oBanner.Show();oBkg1.Show();oBkg2.Hide();oBrandingArea.Show();oBrowseHeader.Show();oCategoryChooser.Hide();oFullScreenPanel.Hide();oMediaPlayer.Show(true);oNavBar.Show();oNowPlaying.Hide();oOnDeckArea.Hide();oProgressBar.Hide();oSlideShow.Hide();oVideoMetadata.Show();oVideoControls.Hide();oMediaPlayer.Div.focus();break;case VIDEOSIZE_MEDIUM:setBodyBg("131517");toggleSlideshow(SLIDESHOW_OFF);oBrandingArea.SetDimensions(51, 20, 29, 201);oMediaPlayer.SetDimensions(226, 41, 320, 240, 3, 3, 3, 3);oAdManager.SetPos(315, 16);oAdManager.Show();oBanner.Show();oBkg1.Hide();oBkg2.Show();oBrandingArea.Show();oBrowseHeader.Hide();oCategoryChooser.Hide();oFullScreenPanel.Hide();oMediaPlayer.Show(true);oNavBar.Hide();oNowPlaying.Show();oOnDeckArea.Show();oProgressBar.Show();oSlideShow.Hide();oVideoMetadata.Hide();oVideoControls.PlayingView();oVideoControls.Show();oVideoControls.Play.focus();break;case VIDEOSIZE_LARGE:setBodyBg("000000");oMediaPlayer.SetDimensions(42, 0, 476, 357, 0, 66, 0, 66);oAdManager.Hide();oBanner.Hide();oBkg1.Hide();oBkg2.Hide();oBrandingArea.Hide();oBrowseHeader.Hide();oCategoryChooser.Hide();oFullScreenPanel.Show();oMediaPlayer.Show(false);oNavBar.Hide();oNowPlaying.Hide();oOnDeckArea.Hide();oProgressBar.Hide();oSlideShow.Hide();oVideoMetadata.Hide();oVideoControls.FullScreenView();oVideoControls.Show();oVideoControls.Play.focus();startFsCountdown();break;case VIDEOSIZE_FULL:setBodyBg("000000");toggleSlideshow(SLIDESHOW_OFF);oMediaPlayer.SetDimensions(0, 0, 560, 420, 0, 0, 0, 0);oAdManager.Hide();oBanner.Hide();oBkg1.Hide();oBkg2.Hide();oBrandingArea.Hide();oBrowseHeader.Hide();oCategoryChooser.Hide();oFullScreenPanel.Hide();oMediaPlayer.Show(false);oNavBar.Hide();oNowPlaying.Hide();oOnDeckArea.Hide();oProgressBar.Hide();oSlideShow.Hide();oVideoMetadata.Hide();oVideoControls.Hide();break;}oBanner.Refresh();refreshStatus();}function setBodyBg(clr){document.body.style.background = clr;}function refreshStatus(){var ps = oMediaPlayer.GetPlayState();var str;if (g_ReadyState < rs_Complete)str = "Connecting";else if (ps == PLAYSTATE_BUFFERING)str = "Loading";else if (ps == PLAYSTATE_STOPPED)str = "Stopped";else if (ps == PLAYSTATE_PLAYING)str = "Playing";else if (ps == PLAYSTATE_PAUSED)str = "Paused";else if (ps == PLAYSTATE_FWD)str = "Fast-forwarding";else if (ps == PLAYSTATE_REW)str = "Rewinding";else str = "";switch(g_nowVideoSize){case VIDEOSIZE_MEDIUM:oProgressBar.SetStatus(str);break;case VIDEOSIZE_LARGE:oVideoControls.SetStatus(str);break;}}function startFsCountdown(){window.clearTimeout(iFullScreenTimerId);iFullScreenTimerId = window.setTimeout(goFullScreen, 15000);}function goFullScreen(){setVideoSize(VIDEOSIZE_FULL);refreshFooter();updateBacklist();}function setNavView(view){oDataFetcher.ClearQueue();g_nowNavView = view;switch (view){case NAV_VIEW_HOME:g_nowTopicInd = -1;g_nowCatInd = -1;setMetaDataGlobals(null, null, null, null, null, null, null, null, null, null, null, null, null, null);oBrowseHeader.Clear();oNavBar.Clear();oNavBar.InitTopics(g_topics);oNavBar.SetFocus();break;case NAV_VIEW_PLAYLIST:var t_types = new Array();var t_GUIDs = new Array();var t_headlines = new Array();var t_captions = new Array();var t_imageUrls = new Array();var t_videoPaths = new Array();for (var i=0; i<oPlaylist.Items.length; i++){var item = oPlaylist.Items[i];t_types[i] = "video";t_GUIDs[i] = item.GUID;t_headlines[i] = item.Title;t_captions[i] = item.Caption;t_imageUrls[i] = item.Thumb;t_videoPaths[i] = item.URL;}setMetaDataGlobals(t_types, t_GUIDs, null, null, null, null, t_headlines, t_captions, null, t_imageUrls, t_videoPaths, null, null, null);oBrowseHeader.MediaCount = g_headlines.length;oBrowseHeader.SetText1("Video Playlist");oNavBar.Clear();oNavBar.InitThumbnails(g_headlines, g_imageUrls, g_GUIDs, "Playlist");if (oPlaylist.Items.length > oNavBar.MenuCount)oNavBar.SetRatchet(oPlaylist.Position);elseoNavBar.SetRatchet(0);oNavBar.SetFocus();if (_playAfterThumbnailLoad){_playAfterThumbnailLoad = false;oPlaylist.MoveTo(0);playCurrent();}break;case NAV_VIEW_BROWSE:var topicId = (g_nowCatInd == -1) ? g_topicIds[g_nowTopicInd] : g_catIds[g_nowTopicInd][g_nowCatInd];var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];oNavBar.Clear();oCategoryChooser.Hide();oBrowseHeader.ShowLoadingMessage(topicName);var url = urlToJsLoader(topicId, "Anduril");oDataFetcher.GetData(url, onBrowseLoadComplete, onBrowseLoadFail);break;default:break;}oBanner.Refresh();}function onBrowseLoadComplete(){try{eval(oDataFetcher.Data);setMetaDataGlobals(t_types, t_GUIDs, t_PGs, t_PSs, t_IDs, t_sources, t_headlines, t_captions, t_imageTypes, t_imageUrls, t_videoPaths, t_articleUrls, t_relatedLinkUrls, t_relatedLinkText);oImagePreloader.Init(g_imageUrls);oImagePreloader.Start();completeBrowseView();}catch (error){onBrowseLoadFail();}refreshFooter();if (_playAfterThumbnailLoad){_playAfterThumbnailLoad = false;oPlaylist.MoveTo(0);playCurrent();}}function onBrowseLoadFail(){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];var badCat = getTopic_Cat(g_nowTopicInd, g_nowCatInd);oCategoryChooser.AppendBadCat(badCat);alert("The " + topicName + " category is currently unavailable. Please try again later.");setNavView(NAV_VIEW_HOME);}function completeBrowseView(){var headerText= "<b>"+ g_topics[g_nowTopicInd]+ " &#151; "+ ((g_nowCatInd == -1) ? "All" : g_cats[g_nowTopicInd][g_nowCatInd])+ "</b>";var itemCount = g_headlines.length;oBrowseHeader.MediaCount = itemCount;oBrowseHeader.SetText1(headerText);oNavBar.InitThumbnails(g_headlines, g_imageUrls, g_GUIDs, g_topics[g_nowTopicInd]);oNavBar.SetFocus();}function refreshFooter(){switch (g_nowVideoSize){case VIDEOSIZE_MEDIUM:oFooter.DrawPlayingView();break;case VIDEOSIZE_LARGE:oFooter.Hide();break;case VIDEOSIZE_FULL:oFooter.Hide();break;default:switch (g_nowNavView){case NAV_VIEW_HOME:oFooter.DrawHomeView();break;case NAV_VIEW_PLAYLIST:oFooter.DrawPlaylistView();break;default:oFooter.DrawBrowseView();break;}break;}}function refreshPlaystateFeedback(){oBrandingArea.Refresh();oNowPlaying.Refresh(false);oNavBar.Refresh();oOnDeckArea.Refresh();oVideoMetadata.Refresh(false);oVideoControls.HideShowBtns();}function toggleSlideshow(setting){g_nowSlideshowMode = setting;if (g_nowSlideshowMode == SLIDESHOW_ON){var slides = new Array();for (var i=0; i<g_ssImages.length; i++){slides[i]= '<img src="'+ g_ssImages[i]+ '" border="0" width="'+ slideShowPanel.offsetWidth+ '" height="'+ slideShowPanel.offsetHeight+ '" />';}var abstracts = new Array();for (var i=0; i<g_ssHeadlines.length; i++){var h1 = "<b>"   + g_ssHeadlines[i]   + "</b>"   + "<p>"   + "</p>"   + g_ssCaptions[i]   ;var h2 = truncateToHeight(295, 135, "20px", h1);abstracts[i]= "<span class=\"ssAbstractTxt\" >"+ h2+ "</span><p/>";}oSlideShow.Init(slides, abstracts);iSlideShowTimerId = window.setTimeout(nextSlide, iSlideShowInterval);}else{window.clearTimeout(iSlideShowTimerId);}}function nextSlide(){window.clearTimeout(iSlideShowTimerId);oSlideShow.Next();iSlideShowTimerId = window.setTimeout(nextSlide, iSlideShowInterval);}function updateBacklist(){oBacklistManager.Append(g_nowTopicInd, g_nowCatInd, g_nowVideoSize, g_nowNavView);}function videoGoBack(){if (oCategoryChooser.Div.style.visibility == "visible"){oCategoryChooser.Hide();oFooter.SetFocus();return;}if (oBacklistManager.Items.length<2){if (okToLeaveApp()){oPlaylist.RemoveAll();oMediaPlayer.Stop();return false;}else{return true;}}var prevState = oBacklistManager.Items[oBacklistManager.Items.length -2];var prevTopic = prevState[0];var prevCat = prevState[1];var prevVidSize = prevState[2];var prevNavView = prevState[3];oBacklistManager.RemoveLast();if ((prevNavView == NAV_VIEW_PLAYLIST) && (oPlaylist.Items.length == 0))return videoGoBack();if (prevVidSize >= VIDEOSIZE_LARGE && oMediaPlayer.GetPlayState() == PLAYSTATE_STOPPED)return videoGoBack();if ((prevVidSize == VIDEOSIZE_NONE) && (g_nowSlideshowMode != SLIDESHOW_ON))prevVidSize = VIDEOSIZE_SMALL;if (oPlaylist.Items.length == 0)prevVidSize = VIDEOSIZE_NONE;if ((g_nowTopicInd == prevTopic) && (g_nowCatInd == prevCat) && (g_nowVideoSize == prevVidSize) && (g_nowNavView == prevNavView))return videoGoBack();g_nowTopicInd = prevTopic;g_nowCatInd = prevCat;setVideoSize(prevVidSize);setNavView(prevNavView);refreshFooter();return true;}function clickHelp(){if (okToLeaveApp())CallPaneHelp(PH_topicTOC,'MSNTV_TRS_TOC_Videos.htm');}function clickSlide(){var a = oSlideShow.Slides[oSlideShow.CurrentSlide].ShowcaseIndex;addSlideshowToPlaylist(a);oMessagePopup.AutoHide("Adding top videos to the playlist and preparing to play");setVideoSize(VIDEOSIZE_MEDIUM);setNavView(NAV_VIEW_PLAYLIST);refreshFooter();updateBacklist();playItemAfterAd(oPlaylist.Position+1);}function clickPlayTop(){clickSlide();}function clickPlayAll(){var topicName = (g_nowCatInd == -1) ? g_topics[g_nowTopicInd] : g_cats[g_nowTopicInd][g_nowCatInd];if (catHasClipsNotInPlaylist()){oMessagePopup.AutoHide("Adding all " + htmlDecode(topicName) + " videos to the playlist and preparing to play");addCategoryToPlaylist();setVideoSize(VIDEOSIZE_MEDIUM);updateBacklist();refreshFooter();playItemAfterAd(oPlaylist.Position+1);}else{clickThumb(0);}}function clickIcon(i){var iconInd = (i + oNavBar.CurrentRatchet) % oNavBar.HTML.length; try{var nowIcon = eval("menuItem_" + i);var ob;if (nowIcon.offsetLeft < 230){if (oVideoMetadata.IsSelectable())ob = oVideoMetadata.GetSelectableOb();if (oSlideShow.AbstractIsSelectable())ob = oSlideShow.AbstractDiv.Button;if (oOnDeckArea.IsSelectable())ob = oOnDeckArea.LinkSpan;}else{if (oAdManager.IsSelectable())ob = oAdManager.SelectableOb();if (oSlideShow.PanelIsSelectable())ob = oSlideShow.SlidePanel;if (oMediaPlayer.IsSelectable())ob = oMediaPlayer.Div;}if (ob!=null)ob.focus();}catch (e){}if (iconInd == oNavBar.HTML.length-1){clickPlaylistButton();}else{g_nowTopicInd = iconInd;g_nowCatInd = -1;setNavView(NAV_VIEW_BROWSE);updateBacklist();}}function overThumb(i){if (g_nowNavView != NAV_VIEW_HOME){var h = "(" + oNavBar.GetThumbIndex(i) + " of " + oBrowseHeader.MediaCount + ")";oBrowseHeader.SetText2(h);}}function clickBrowseButton(){oCategoryChooser.Show(g_nowTopicInd, g_nowCatInd);}function overBrowseButton(){oCategoryChooser.Hide();}function offBrowseButton(){oCategoryChooser.Hide();oNavBar.SetFocus();}function clickPip(){switch (g_nowVideoSize){case VIDEOSIZE_SMALL:setVideoSize(VIDEOSIZE_MEDIUM);updateBacklist();refreshFooter();break;case VIDEOSIZE_MEDIUM:setVideoSize(VIDEOSIZE_LARGE);updateBacklist();refreshFooter();break;}}function clickMoreInfo(){setVideoSize(VIDEOSIZE_SMALL);refreshFooter();updateBacklist();}function clickNormalView(){setVideoSize(VIDEOSIZE_MEDIUM);refreshFooter();updateBacklist();oVideoControls.Play.focus();}function clickBrwsBtn(i,j){oFooter.SetFocus();toCat(i,j);}function toCat(a,b){g_nowTopicInd = a;g_nowCatInd = b;setNavView(NAV_VIEW_BROWSE);updateBacklist();}function clickPlaylistButton(){if (oPlaylist.Items.length == 0){alert("Your playlist is empty. To add videos to your playlist, first choose a category, then find the video you want to add and press OK on your keyboard or remote control.");return;}if (g_nowVideoSize == VIDEOSIZE_MEDIUM)setVideoSize(VIDEOSIZE_SMALL);g_nowTopicInd = -1;g_nowCatInd = -1;setNavView(NAV_VIEW_PLAYLIST);refreshFooter();updateBacklist();}function clickHomeButton(){if (g_nowVideoSize == VIDEOSIZE_MEDIUM)setVideoSize(VIDEOSIZE_SMALL);setNavView(NAV_VIEW_HOME);refreshFooter();updateBacklist();}function clickDeleteAll(){if (oMessagePopup.Confirm("Are you sure you want to empty your playlist?")){oPlaylist.RemoveAll();g_ForceFullStop = true;oMediaPlayer.Stop();onPlaylistEnd();oMediaPlayer.IsPlayingAd = false;}}function clickAd(){DeviceClickAway(oAdManager.GetClickThroughUrl());}function clickFullScreen(){setVideoSize(VIDEOSIZE_LARGE);updateBacklist();refreshFooter();}function clickRelatedLink(url, ind){var trackingUrl = oTrackingManager.TrackRelatedLink(url, ind, oPlaylist.GetCurrent());DeviceClickAway(trackingUrl);}function onPlayListChange(){refreshPlaystateFeedback();}function onPrepareToPlay(){if (g_nowVideoSize == VIDEOSIZE_NONE){setVideoSize(VIDEOSIZE_SMALL);updateBacklist();refreshFooter();}}function onPlaylistEnd(){setNavView(NAV_VIEW_HOME);setVideoSize(VIDEOSIZE_NONE);refreshFooter();updateBacklist();oNavBar.Refresh();oNavBar.SetFocus();}function trackViewedClip(guid){var url = urlToUserActivity();url += "action=saveGuid&guid=" + guid;oDataFetcher.GetData(url, onTrackClip, onTrackClipFail);}function onTrackClip(){}function onTrackClipFail(){}function ratchetNavBar(dir, i){if (oNavBar.HTML.length > oNavBar.MenuCount){if (dir=='l')if (oNavBar.CurrentRatchet==0)oNavBar.Draw(oNavBar.HTML.length-1);elseoNavBar.Draw(oNavBar.CurrentRatchet-1);elseif (oNavBar.CurrentRatchet==oNavBar.HTML.length-1)oNavBar.Draw(0);elseoNavBar.Draw(oNavBar.CurrentRatchet+1);}if (g_nowNavView != NAV_VIEW_HOME){var h = "(" + oNavBar.GetThumbIndex(i) + " of " + oBrowseHeader.MediaCount + ")";oBrowseHeader.SetText2(h);}}function clickThumb(ind){handleThumbClick(ind, oMediaPlayer.IsLoading);}